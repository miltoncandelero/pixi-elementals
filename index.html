
<!doctype html>
<html>
  <head>
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32-94db8bb5.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16-f7a9ef35.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="canonical" href="https://www.pixijselementals.com">
    <meta name="title" content="PixiJS Elementals">
    <meta name="description" content="A compilation of essential knowledge to get started making games and content with PixiJS. Boilerplate included!">
    <meta name="keywords" content="pixijs, typescript, tutorial, guide, boilerplate, elementals, course">
    <meta name="robots" content="index, follow">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="language" content="English">
    <meta name="author" content="Milton Candelero (elementalcode)">
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>PixiJS Elementals</title>

    <style media="screen">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sa {
  color: #6c71c4;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>
    <link href="stylesheets/screen-c9d8fa83.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-953e3353.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-b12a2749.js"></script>

    <script>
      $(function() { setupCodeCopy(); });
    </script>
  </head>

  <body class="index" data-languages="[]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar-cad8cdcb.png" alt="" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-ee433a82.png" class="logo" alt="" />
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#getting-started" class="toc-h1 toc-link" data-title="Getting Started">Getting Started</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#before-we-even-start" class="toc-h2 toc-link" data-title="Before we even start...">Before we even start...</a>
                  </li>
                  <li>
                    <a href="#enough-talk-have-at-you" class="toc-h2 toc-link" data-title="Enough talk, have at you!">Enough talk, have at you!</a>
                  </li>
                  <li>
                    <a href="#finally-some-code" class="toc-h2 toc-link" data-title="Finally some code!">Finally some code!</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#putting-stuff-on-screen" class="toc-h1 toc-link" data-title="Putting stuff on screen">Putting stuff on screen</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#the-displaylist" class="toc-h2 toc-link" data-title="The DisplayList">The DisplayList</a>
                  </li>
                  <li>
                    <a href="#a-quick-overview-of-the-display-objects-you-can-use-out-of-the-box" class="toc-h2 toc-link" data-title="A quick overview of the Display Objects you can use out of the box.">A quick overview of the Display Objects you can use out of the box.</a>
                  </li>
                  <li>
                    <a href="#container" class="toc-h2 toc-link" data-title="Container">Container</a>
                  </li>
                  <li>
                    <a href="#sprite" class="toc-h2 toc-link" data-title="Sprite">Sprite</a>
                  </li>
                  <li>
                    <a href="#graphics" class="toc-h2 toc-link" data-title="Graphics">Graphics</a>
                  </li>
                  <li>
                    <a href="#text" class="toc-h2 toc-link" data-title="Text">Text</a>
                  </li>
                  <li>
                    <a href="#bitmaptext" class="toc-h2 toc-link" data-title="BitmapText">BitmapText</a>
                  </li>
                  <li>
                    <a href="#filters" class="toc-h2 toc-link" data-title="Filters">Filters</a>
                  </li>
                  <li>
                    <a href="#particles" class="toc-h2 toc-link" data-title="Particles">Particles</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#context" class="toc-h1 toc-link" data-title="Context">Context</a>
          </li>
          <li>
            <a href="#splitting-code" class="toc-h1 toc-link" data-title="Splitting code">Splitting code</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#a-quick-preview-of-scenes" class="toc-h2 toc-link" data-title="A quick preview of Scenes">A quick preview of Scenes</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#animating-stuff" class="toc-h1 toc-link" data-title="Animating stuff">Animating stuff</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#animatedsprite" class="toc-h2 toc-link" data-title="AnimatedSprite">AnimatedSprite</a>
                  </li>
                  <li>
                    <a href="#ticker" class="toc-h2 toc-link" data-title="Ticker">Ticker</a>
                  </li>
                  <li>
                    <a href="#tweens" class="toc-h2 toc-link" data-title="Tweens">Tweens</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#getting-interactive" class="toc-h1 toc-link" data-title="Getting interactive">Getting interactive</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#pointer-events" class="toc-h2 toc-link" data-title="Pointer Events">Pointer Events</a>
                  </li>
                  <li>
                    <a href="#keyboard" class="toc-h2 toc-link" data-title="Keyboard">Keyboard</a>
                  </li>
                  <li>
                    <a href="#making-custom-events-and-the-overall-syntax" class="toc-h2 toc-link" data-title="Making custom events and the overall syntax">Making custom events and the overall syntax</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#collision-detection" class="toc-h1 toc-link" data-title="Collision detection">Collision detection</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#pure-rectangle-math" class="toc-h2 toc-link" data-title="Pure rectangle math">Pure rectangle math</a>
                  </li>
                  <li>
                    <a href="#displayobjects-into-rectangles" class="toc-h2 toc-link" data-title="DisplayObjects into Rectangles">DisplayObjects into Rectangles</a>
                  </li>
                  <li>
                    <a href="#a-note-on-colliding-polygons" class="toc-h2 toc-link" data-title="A note on colliding polygons.">A note on colliding polygons.</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#sounding-good" class="toc-h1 toc-link" data-title="Sounding Good">Sounding Good</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#playing-a-sound" class="toc-h2 toc-link" data-title="Playing a sound">Playing a sound</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#recipes" class="toc-h1 toc-link" data-title="Recipes">Recipes</a>
          </li>
          <li>
            <a href="#recipe-preloading-assets" class="toc-h1 toc-link" data-title="Recipe: Preloading assets">Recipe: Preloading assets</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#first-of-all-a-primer-on-promises" class="toc-h2 toc-link" data-title="First of all, a primer on Promises.">First of all, a primer on <em>Promises</em>.</a>
                  </li>
                  <li>
                    <a href="#using-assets" class="toc-h2 toc-link" data-title="Using Assets">Using <em>Assets</em></a>
                  </li>
                  <li>
                    <a href="#the-files-to-download-manifest" class="toc-h2 toc-link" data-title="The files-to-download Manifest.">The files-to-download Manifest.</a>
                  </li>
                  <li>
                    <a href="#using-our-manifest" class="toc-h2 toc-link" data-title="Using our Manifest">Using our <em>Manifest</em></a>
                  </li>
                  <li>
                    <a href="#making-it-look-pretty" class="toc-h2 toc-link" data-title="Making it look pretty">Making it look pretty</a>
                  </li>
                  <li>
                    <a href="#how-to-easily-use-your-loaded-sprites-and-sounds" class="toc-h2 toc-link" data-title="How to easily use your loaded Sprites and Sounds?">How to easily use your loaded Sprites and Sounds?</a>
                  </li>
                  <li>
                    <a href="#advanced-loading" class="toc-h2 toc-link" data-title="Advanced loading">Advanced loading</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#recipe-scene-manager" class="toc-h1 toc-link" data-title="Recipe: Scene Manager">Recipe: Scene Manager</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#the-manager-class" class="toc-h2 toc-link" data-title="The Manager Class">The Manager Class</a>
                  </li>
                  <li>
                    <a href="#now-some-reruns-of-your-favorite-classes" class="toc-h2 toc-link" data-title="Now, some reruns of your favorite classes!">Now, some reruns of your favorite classes!</a>
                  </li>
                  <li>
                    <a href="#turning-on-the-entire-machine" class="toc-h2 toc-link" data-title="Turning on the entire machine">Turning on the entire machine</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#recipe-resize-your-game" class="toc-h1 toc-link" data-title="Recipe: Resize your game">Recipe: Resize your game</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#letterbox-scale" class="toc-h2 toc-link" data-title="Letterbox scale">Letterbox scale</a>
                  </li>
                  <li>
                    <a href="#responsive-scale" class="toc-h2 toc-link" data-title="Responsive Scale">Responsive Scale</a>
                  </li>
                  <li>
                    <a href="#resolution-device-pixel-ratio" class="toc-h2 toc-link" data-title="Resolution (Device Pixel Ratio)">Resolution (Device Pixel Ratio)</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#older-guides" class="toc-h1 toc-link" data-title="Older guides">Older guides</a>
          </li>
          <li>
            <a href="#recipe-preloading-assets-v6" class="toc-h1 toc-link" data-title="Recipe: Preloading assets v6">Recipe: Preloading assets v6</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#the-file-to-download-manifest" class="toc-h2 toc-link" data-title="The file to download manifest.">The file to download manifest.</a>
                  </li>
                  <li>
                    <a href="#how-to-use-the-loader" class="toc-h2 toc-link" data-title="How to use the Loader">How to use the <em>Loader</em></a>
                  </li>
                  <li>
                    <a href="#making-it-look-pretty" class="toc-h2 toc-link" data-title="Making it look pretty">Making it look pretty</a>
                  </li>
                  <li>
                    <a href="#how-to-easily-use-your-loaded-sprites-and-sounds" class="toc-h2 toc-link" data-title="How to easily use your loaded Sprites and Sounds?">How to easily use your loaded Sprites and Sounds?</a>
                  </li>
                  <li>
                    <a href="#advanced-loading" class="toc-h2 toc-link" data-title="Advanced loading">Advanced loading</a>
                  </li>
              </ul>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://commerce.coinbase.com/checkout/aadf6aa9-fa06-4a7f-b4b2-3ca868b86b9a'>If you have money to spare...</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p><em>&quot;When you wish to instruct, be brief&quot; - Cicero</em></p>

<p>This is a summary of the knowledge I have gathered along my career and I think is essential to get started making games and content with PixiJS.</p>

<p><a href="https://www.pixijs.com/">PixiJS</a> is an HTML5 Creation Engine and can be used to create beautiful digital content with the fastest, most flexible 2D WebGL renderer.</p>

<p>We could spend pages and pages discussing what PixiJS is and isn&#39;t, or if you should or shouldn&#39;t use it over other engines, frameworks, or libraries <strong>but I refuse to do so</strong>. I assume that if you are here is because you already made your mind so I won&#39;t try to convince you.</p>

<p>Let&#39;s get straight to teaching!</p>
<h1 id='getting-started'>Getting Started</h1><h2 id='before-we-even-start'>Before we even start...</h2>
<p>This tutorial won&#39;t teach you to code from scratch. I will assume you already know your way around code and object-oriented programming.<br>
Git and some shell (console) experience will be good but not mandatory. If you know any object-oriented programming you will be just fine.  </p>
<h3 id='this-ain-39-t-your-grandma-39-s-javascript'>This ain&#39;t your grandma&#39;s Javascript...</h3>
<p>If you came here expecting to write javascript between two <code>&lt;script&gt;</code> tags in your .html file, oh boy I have bad news for you.<br>
Web development might have started with only a text editor and dumping code into a single .js file but in today&#39;s spooky fast world of javascript libraries, going commando ain&#39;t gonna cut it.<br>
This... guide? course? tutorial? will use Typescript and it will be designed to work with <a href="https://github.com/miltoncandelero/pixi-hotwire"><em>pixi-hotwire</em></a>, a boilerplate to get you started fast without the hassle of how to create and maintain a standard web project with a bundler. (If you have a bit more experience in web development, feel free to tinker and try any bundler of your liking.)    </p>
<h3 id='pixi-hotwire'>pixi-hotwire?</h3>
<p>In case you realize you have no idea what a bundler is or why you need one, worry not! I&#39;ve created a base template project called <a href="https://github.com/miltoncandelero/pixi-hotwire"><em>pixi-hotwire</em></a>. It is the simplest boilerplate I could build. It goes from nothing to watching your code running with the least amount of configurations.<br>
It is a <em>just-add-npm</em> solution that sets you up with <em>typescript</em>, <em>pixi.js</em> and <em>webpack</em>. It also will make a final build folder for you instead of you having to pluck manually files out of your project folder to get the <em>uploadeable</em> result of your hard work.</p>
<h3 id='typescript'>Typescript?</h3>
<p>I&#39;ll be honest with you: I hate Javascript. I hate the meme of truthy and falsy values. I hate the implicit type coercion. I hate the dynamic context binding. I hate a lot of javascript... But I must endure, adapt, overcome.<br>
Enter Typescript: Typescript will force your hand to keep your code as strictly typed as possible, and if you need to use type coercion and really <em>javascripty</em> code, you must consciously choose to make the data type as <code>any</code>.<br>
As a nice bonus, you get <em>intellisense</em> on Visual Studio Code (which is Microsoft&#39;s fancy name for code auto-complete).  </p>
<h3 id='i-will-never-scream-pixi'>I will never scream (<code>PIXI.</code>)</h3>
<p>I feel that doing <code>import * as PIXI from &quot;pixi.js&quot;</code> so that I can go <code>PIXI.Sprite</code>, <code>PIXI.Container</code>, <code>PIXI.Assets</code>, etc, is silly and makes me feel clumsy. I will use named imports: <code>import { Sprite, Container, Assets } from &quot;pixi.js&quot;</code> and that allows me to just use the class name without adding <code>PIXI</code> everywhere.<br>
I could say it is better for three-shaking (the step where the bundler doesn&#39;t add to your code stuff that you never use) or that I fight the smurf naming convention... but at the end of the day I just like named imports better. Sorry, not sorry.  </p>
<h2 id='enough-talk-have-at-you'>Enough talk, have at you!</h2>
<blockquote>
<p>Be patient. When the time is right, the code will be shown in this column.</p>
</blockquote>

<p>Let&#39;s start by making sure you have all the tools and materials.  </p>

<p>You will need:</p>

<ul>
<li><a href="https://nodejs.org/">NodeJS</a> (it comes with <code>npm</code>).</li>
<li><a href="https://github.com/miltoncandelero/pixi-hotwire">pixi-hotwire</a> boilerplate.</li>
<li>A text editor (consider <a href="https://code.visualstudio.com/">Visual Studio Code</a> but any would do)</li>
<li>A web browser from this era. (Sorry internet explorer, you are out!)</li>
</ul>

<p>A quick overview of what you will find inside <em>pixi-hotwire</em>:</p>

<ul>
<li><code>src</code> folder: Contains the typescript code for your project.</li>
<li><code>static</code> folder: Contains all the assets (non-code) for your project.</li>
<li><code>package.json</code> file: Contains a list of all the libraries and tools you need along with some script code to run and build your project. The heart and soul of any <code>npm</code> project.</li>
<li><code>dist</code> folder: Won&#39;t be there yet. Here you will find the ready-to-upload build when you want to share your game.</li>
</ul>

<p>Once you have cloned or downloaded <em>pixi-hotwire</em> you will need to grab all the dependencies (stored inside the <code>package.json</code> file), to do so you will need to use a shell (console), navigate to the project folder and use the command <code>npm install</code> to read all the dependencies and download them into the <code>node_modules</code> folder.  </p>

<p>When the progress finishes you now have access to new stuff that begins with <code>npm</code>!</p>

<ul>
<li><code>npm run start</code> will convert your typescript into javascript as you write it and let you test the game! 

<ul>
<li>&quot;as you write&quot; means you just need to save the file you are working in order to see the changes, no need to run it again!</li>
</ul></li>
<li><code>npm run build</code> will create a package for you to upload to your webserver. Find it inside the folder <code>dist</code> (short for distributable)

<ul>
<li>Don&#39;t try to &quot;just double click&quot; the index.html file there. It may work, it may not. This is meant to upload into a webserver or service. When your game is ready you can try uploading to <a href="https://itch.io/">itch.io</a>.</li>
</ul></li>
</ul>

<p>Run <code>npm run start</code> and open your web browser on the website <code>http://localhost:1234</code>.<br>
<code>localhost</code> means &quot;your own computer&quot; and <code>1234</code> is the port where this web server is running. Nobody else will see your game running on their <code>localhost</code>. You will need to export it and upload it somewhere.<br>
Try hitting F12 and finding the Javascript Console. That will be your best friend when needing to know why something is or isn&#39;t working. That is where <code>console.log()</code> will write and where you will see any errors that you might have made.</p>
<h2 id='finally-some-code'>Finally some code!</h2>
<blockquote>
<p>Now, for the actual code inside the <code>index.ts</code> file</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Application</span><span class="p">,</span> <span class="nx">Sprite</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">pixi.js</span><span class="dl">'</span>

<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Application</span><span class="p">({</span>
    <span class="na">view</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">pixi-canvas</span><span class="dl">"</span><span class="p">)</span> <span class="k">as</span> <span class="nx">HTMLCanvasElement</span><span class="p">,</span>
    <span class="na">resolution</span><span class="p">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">devicePixelRatio</span> <span class="o">||</span> <span class="mi">1</span><span class="p">,</span>
    <span class="na">autoDensity</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">backgroundColor</span><span class="p">:</span> <span class="mh">0x6495ed</span><span class="p">,</span>
    <span class="na">width</span><span class="p">:</span> <span class="mi">640</span><span class="p">,</span>
    <span class="na">height</span><span class="p">:</span> <span class="mi">480</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="nx">clampy</span><span class="p">:</span> <span class="nx">Sprite</span> <span class="o">=</span> <span class="nx">Sprite</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">"</span><span class="s2">clampy.png</span><span class="dl">"</span><span class="p">);</span>

<span class="nx">clampy</span><span class="p">.</span><span class="nx">anchor</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="mf">0.5</span><span class="p">);</span>

<span class="nx">clampy</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">screen</span><span class="p">.</span><span class="nx">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
<span class="nx">clampy</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">screen</span><span class="p">.</span><span class="nx">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">stage</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">clampy</span><span class="p">);</span>
</code></pre></div>
<p>First, we see the <code>import</code> statement. As previously stated, I prefer named imports to just importing everything under a big all-caps <code>PIXI</code> object.  </p>

<p>After that, we create an <code>app</code> instance of PixiJS <code>Application</code>. This object is a quick way to set up a renderer and a stage to drop stuff on screen and be ready to render. You can see that I call for an HTML element by id <code>pixi-canvas</code>, this element can be found on the <code>index.ejs</code> file. (The ejs file is template that <em>webpack</em> will use to create your final <code>index.html</code> with your code bundle referenced inside)
As a parameter for the <code>Application</code> object, we give it some options. You can see and explore the full list in <a href="https://pixijs.download/dev/docs/PIXI.Application.html">PixiJS official docs</a>.  </p>

<p>Then, I create a <code>Sprite</code> with the <code>Sprite.from(...)</code> method, this is a super powerful shortcut that can take as a parameter one of many things, among which we can find:</p>

<ul>
<li>A <code>Texture</code> object.</li>
<li>The name of a <code>Texture</code> object you loaded previously. (using <code>Assets</code>, we will see this when we get to <a href="#recipe-preloading-assets">loading assets</a>)</li>
<li>The URL of an image file</li>
</ul>

<p>Can you guess what we used here?<br>
Well, I hope you guessed option three, &quot;the URL of an image file&quot; because that is the correct option.<br>
By saying <code>&quot;clampy.png&quot;</code> it means &quot;find a file called clampy.png in the root of my asset folder&quot;. You will see that our asset folder is called <code>static</code> and if you check in there, indeed there it is, <code>clampy.png</code>!  </p>

<p>Finally, I set the position of Clampy and add it to the screen by doing an <code>addChild()</code> to the <code>app.stage</code>.<br>
You will learn soon enough what the stage and why is it called <code>addChild()</code> but for now it should suffice to know that <code>app.stage</code> is the name for &quot;the entire screen&quot; and everything that you want to show needs to be appended by using <code>addChild()</code>.</p>
<h3 id='homework'>Homework!</h3>
<p>Oh boy, you thought you could get away?<br>
Try these on for size!</p>

<ul>
<li>Try moving the <code>clampy.png</code> into a folder (keeping it inside <code>static</code>!)

<ul>
<li>Now, try referencing the new location to make Clampy appear again</li>
</ul></li>
<li>Try using an image from the internet, say from <a href="https://imgur.com/">imgur</a>

<ul>
<li>Make sure your file ends with <code>.png</code> or <code>.jpg</code>, which means it is the actual image file.</li>
</ul></li>
<li>Try an image from a random website. (it may work, it may not, don&#39;t panic)

<ul>
<li>Did you get a <code>blocked by CORS</code> error on the javascript console? <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">CORS</a> is a safety measure to prevent a webpage from calling other webpages without your permission, this is why we have our own images on the <code>static</code> folder!.</li>
</ul></li>
</ul>
<h1 id='putting-stuff-on-screen'>Putting stuff on screen</h1>
<p><em>(and being in control of said stuff)</em></p>
<h2 id='the-displaylist'>The DisplayList</h2>
<p><em>In my not-so-humble opinion, the best way to handle 2d graphics.</em>  </p>

<p>It all starts with an abstract class: The <code>DisplayObject</code>. Anything that can be shown on the screen <strong>must</strong> inherit from this abstract class at some point in his genealogy. When I want to refer to &quot;anything that can be placed on the screen&quot; I will use the generic term <code>DisplayObject</code>.<br>
In PixiJS your bread and butter are going to be <code>Container</code> and <code>Sprite</code>. <em>Sprites</em> can show graphics (if you come from the <a href="#getting-started">getting started</a> you&#39;ve already seen it in action) and <em>Containers</em> are used to group sprites to move, rotate and scale them as a whole. You can add a <em>Container</em> to another <em>Container</em> and keep going as deep as you need your rabbit hole to go.<br>
Imagine a cork bulletin board, some photos, and a box of thumbtacks. You could pin every photo directly to the board... or you could pin some photos to another and then move them all together by moving the photo you pinned every other photo to.<br>
In this relationship, the <em>Container</em> is called the <strong>parent</strong> and the <em>DisplayObjects</em> that are attached to this parent are called <strong>children</strong>.
Things are rendered <em>back-to-front</em>, which means that children will always be covering their parents. Between siblings (children with the same parent), the render order will start from the first added child and move to the last one, making the last child added show on top of all his siblings (unless you use the <code>zOrder</code> property of any display object. However, this property only works between siblings. A child will never be able to be behind his parent).<br>
I know that it has <strong>list</strong> in the name, but it actually looks more like a tree. If you are a nerd like me and understand data structures, imagine a tree structure where each node can have any number of nodes attached that can have more nodes attached...<br>
Finally, we have the root of everything, the granddaddy of them all, the greatest of grandfathers, and we shall call it the <code>Stage</code>. The stage is just a regular container that the <code>Application</code> class creates for us and feeds it to the <code>Renderer</code> to... well render it.</p>
<h3 id='have-some-code'>Have some code</h3><div class="highlight"><pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Application</span><span class="p">,</span> <span class="nx">Sprite</span><span class="p">,</span> <span class="nx">Container</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">pixi.js</span><span class="dl">'</span>

<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Application</span><span class="p">({</span>
    <span class="na">view</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">pixi-canvas</span><span class="dl">"</span><span class="p">)</span> <span class="k">as</span> <span class="nx">HTMLCanvasElement</span><span class="p">,</span>
    <span class="na">resolution</span><span class="p">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">devicePixelRatio</span> <span class="o">||</span> <span class="mi">1</span><span class="p">,</span>
  <span class="na">autoDensity</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">backgroundColor</span><span class="p">:</span> <span class="mh">0x6495ed</span><span class="p">,</span>
    <span class="na">width</span><span class="p">:</span> <span class="mi">640</span><span class="p">,</span>
    <span class="na">height</span><span class="p">:</span> <span class="mi">480</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="nx">conty</span><span class="p">:</span> <span class="nx">Container</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Container</span><span class="p">();</span>
<span class="nx">conty</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>
<span class="nx">conty</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">stage</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">conty</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">clampy</span><span class="p">:</span> <span class="nx">Sprite</span> <span class="o">=</span> <span class="nx">Sprite</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">"</span><span class="s2">clampy.png</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">clampy</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="nx">clampy</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="nx">conty</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">clampy</span><span class="p">);</span>
</code></pre></div>
<p>Ok, let&#39;s make a simple example to test <code>Container</code> and <code>Sprite</code>.  </p>

<p>It should look fairly familiar, but let&#39;s go real quick over it...<br>
We create <em>conty</em> the <code>Container</code> and add it to the <code>app.stage</code>. That means that it is added to the screen and should get rendered but it is empty...<br>
So we create <em>clampy</em> the clamp <code>Sprite</code> like the last time but instead of adding it directly to the screen, we add it to <em>conty</em> the <code>Container</code>.<br>
Now, see how we set Clampy&#39;s position to 100, 100 but if you run it, you will see that it is not showing up there but way more to the side... why?<br>
Well, we added Clampy to <em>conty</em> and he has an <code>x</code> value of 200. That means that Clampy now has a <em>global</em> <code>x</code> value of 300!</p>
<h4 id='homework'>Homework!</h4>
<p>Ok, let&#39;s try some things and see what happens!</p>

<ul>
<li>Try making more Containers and setting different positions.

<ul>
<li>Try to be able to predict where the sprite will end up by keeping a mental map of all the parents and grandparents it has.</li>
</ul></li>
<li>Try adding the same sprite twice to two different containers... Did it work?

<ul>
<li>Spoiler alert, it won&#39;t work. A <em>DisplayObject</em> can&#39;t have two parents, it will become unattached from his current parent to go to the new one.</li>
<li>Make more sprites with <code>Sprite.from()</code> to test multiple sprites on screen.</li>
</ul></li>
<li>Try using a <code>Sprite</code> as a <code>Container</code>.

<ul>
<li>This works because <code>Sprite</code> actually inherits from <code>Container</code>!</li>
</ul></li>
<li>Try rotations and scales on parents. See how the origin of the parent becomes relevant to the position of the children?

<ul>
<li>Try to make a sprite rotate around his center without using <code>origin</code> or <code>anchor</code> but instead centering it on the origin of his parent and rotating his parent.</li>
<li>Fun fact: in ye&#39; old times this was the only way to have a sprite rotate around his center!</li>
</ul></li>
</ul>
<h2 id='a-quick-overview-of-the-display-objects-you-can-use-out-of-the-box'>A quick overview of the Display Objects you can use out of the box.</h2>
<p><em>Note: I will just give you a quick overview and a link to the official PixiJS API, if you want to know everything about an object you should got here.</em></p>
<h2 id='container'>Container</h2>
<blockquote>
<p>an example where <code>bigConty</code> is the papa of <code>littleConty</code>.</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">bigConty</span><span class="p">:</span> <span class="nx">Container</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Container</span><span class="p">();</span>
<span class="nx">bigConty</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="c1">// You can use set and only one value to set x and y</span>
<span class="nx">bigConty</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="nx">bigConty</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span> <span class="c1">// this is a shortcut for .position.y and it also exists one for .position.x</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">stage</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">bigConty</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">littleConty</span><span class="p">:</span> <span class="nx">Container</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Container</span><span class="p">();</span>
<span class="c1">// position has a copy setter. It won't use your reference but copy the values from it!</span>
<span class="nx">littleConty</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Point</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span><span class="mi">200</span><span class="p">);</span>
<span class="nx">bigConty</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">littleConty</span><span class="p">);</span>
</code></pre></div>
<blockquote>
<p>A bit of a silly example, it won&#39;t show anything on screen since containers don&#39;t have content by themselves.</p>
</blockquote>

<p>The most basic class you will have. While it doesn&#39;t have any graphical representation on its own, you can use it to group other objects and affect them as a unit.<br>
<a href="https://pixijs.download/dev/docs/PIXI.Container.html">PixiJS Container API</a><br>
Methods and properties that you will use most frequently:  </p>

<ul>
<li><code>addChild(...)</code>: You use this to add something to the container.</li>
<li><code>removeChild(...)</code>: You use this to remove said something to the container.</li>
<li><code>children</code>: An array of the objects you added to the container.</li>
<li><code>position</code>, <code>scale</code> and <code>skew</code>: If you care to know, those are two PixiJS <a href="https://pixijs.download/dev/docs/PIXI.ObservablePoint.html">Point</a>

<ul>
<li><code>position.x</code> and <code>position.y</code> have shortcuts on <code>.x</code> and <code>.y</code></li>
<li>Even if <code>position</code> is an object, setting it to a new position or to another object&#39;s position won&#39;t break it since it has a setter that copies the value! This makes <code>one.position = another.position</code> totally safe!</li>
</ul></li>
<li><code>rotation</code> and <code>angle</code>: Rotation is in <em>radians</em> while angle is in <em>degrees</em>. Changing one updates the other. </li>
<li><code>width</code> and <code>height</code>: The size of a container it&#39;s defined by the size of a box that contains all his children. This means it changes if the children move. 

<ul>
<li><strong>Changing these values modifies the scale of the object.</strong></li>
</ul></li>
<li><code>interactive</code>, <code>on(...)</code> and <code>off(...)</code>: With this, you can manage your event listeners. It will be really useful when we get to see <a href="#getting-interactive">interacting with your display objects</a></li>
<li><code>getBounds(...)</code>: Will give you a rectangle of this object. It will be very useful for <a href="#collision-detection">detecting basic collisions</a>.</li>
<li><code>destroy()</code> This will remove the object from his parent and render it unusable forever. After that, get rid of any reference and the garbage collector should eat it.</li>
</ul>
<h3 id='particle-container'>Particle Container</h3>
<blockquote>
<p>There isn&#39;t much to them, it&#39;s like a regular container</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">particleConty</span><span class="p">:</span> <span class="nx">ParticleContainer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ParticleContainer</span><span class="p">();</span>
<span class="c1">// Pretty much everything that worked on a Container will work with a ParticleContainer.</span>
</code></pre></div>
<p>A <a href="https://pixijs.download/dev/docs/PIXI.ParticleContainer.html">Particle Container</a> is a special kind of container designed to go fast. To achieve this extra speed you sacrifice some functionality.<br>
The rules for Particle Containers are:</p>

<ul>
<li><strong>No grandchildren</strong>: Children of a ParticleContainer can&#39;t have children.</li>
<li><strong>No fancy stuff</strong>: Filters and Masks won&#39;t work here.</li>
<li><strong>Single texture</strong>: All Sprites inside a ParticleContainer <strong>must</strong> come from the same texture. If you are using texture atlases this is easier to achieve. If you ever see one of your sprites inside a ParticleContainer looking like a garbled mess of another sprite it is probably because they were not sharing a texture.</li>
</ul>

<p>While the name seems to indicate that <em>Particle Containers</em> should be used for <em>Particles</em> you can use them as super fast containers when you need to render a lot of objects.</p>

<aside class="notice">
If you check the PixiJS documentation for ParticleContainer you will see no mention of the <b>single texture</b> rule. However, trust me that this rule is true... or try to prove me wrong and see how your sprites become garbled messes.
</aside>
<h2 id='sprite'>Sprite</h2>
<blockquote>
<p>The simple example from the getting started</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">clampy</span><span class="p">:</span> <span class="nx">Sprite</span> <span class="o">=</span> <span class="nx">Sprite</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">"</span><span class="s2">clampy.png</span><span class="dl">"</span><span class="p">);</span>

<span class="nx">clampy</span><span class="p">.</span><span class="nx">anchor</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="mf">0.5</span><span class="p">);</span>

<span class="c1">// setting it to "the middle of the screen</span>
<span class="nx">clampy</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">screen</span><span class="p">.</span><span class="nx">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
<span class="nx">clampy</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">screen</span><span class="p">.</span><span class="nx">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">stage</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">clampy</span><span class="p">);</span>
</code></pre></div>
<blockquote>
<p>Here we use again the shortcuts for <code>position</code>. </p>
</blockquote>

<p>The simplest way to show a bitmap on your screen. It inherits from <code>Container</code> so all the properties from above apply here too!<br>
<a href="https://pixijs.download/dev/docs/PIXI.Sprite.html">PixiJS Sprite API</a><br>
Methods and properties that you will use most frequently:  </p>

<ul>
<li><code>Sprite.from(...)</code>: This is a static method to create new sprites. It does some black magic inside it so that it can take a lot of different kinds of parameters. (You technically can use the <code>new Sprite(...)</code> way of creating sprites but this is way easier).<br>
This method can take any of the following parameters:

<ul>
<li>Name of a texture you loaded before (we will see <a href="#recipe-preloading-assets">how to load assets in another chapter</a>).</li>
<li>URL of an image or video. This can be an absolute one (<code>http://somedomain.com/image.png</code>) or relative (<code>assets/image.png</code>).</li>
<li>A PixiJS Base texture</li>
<li>A canvas or video HTML element</li>
</ul></li>
<li><code>anchor</code>: This allows you to set where you want the center of this sprite to be. <code>0, 0</code> sets the origin to the left and top, and <code>1, 1</code> means the right and bottom.</li>
<li><code>tint</code>: Fast way to color a sprite. The default value is white <code>0xFFFFFF</code> and this means no color change. <strong>This is done inside the shader and is F R E E. No performance hit whatsoever!</strong></li>
</ul>
<h2 id='graphics'>Graphics</h2>
<blockquote>
<p>There is SO much stuff you can do with graphics... Let&#39;s just make a circle at 100,100</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">graphy</span><span class="p">:</span> <span class="nx">Graphics</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Graphics</span><span class="p">();</span>

<span class="c1">// we give instructions in order. begin fill, line style, draw circle, end filling</span>
<span class="nx">graphy</span><span class="p">.</span><span class="nx">beginFill</span><span class="p">(</span><span class="mh">0xFF00FF</span><span class="p">);</span>
<span class="nx">graphy</span><span class="p">.</span><span class="nx">lineStyle</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mh">0x00FF00</span><span class="p">);</span>
<span class="nx">graphy</span><span class="p">.</span><span class="nx">drawCircle</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">);</span> <span class="c1">// See how I set the drawing at 0,0? NOT AT 100, 100!</span>
<span class="nx">graphy</span><span class="p">.</span><span class="nx">endFill</span><span class="p">();</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">stage</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">graphy</span><span class="p">);</span> <span class="c1">//I can add it before setting position, nothing bad will happen.</span>

<span class="c1">// Here we set it at 100,100</span>
<span class="nx">graphy</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="nx">graphy</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
</code></pre></div>
<blockquote>
<p>I can&#39;t stress this enough: <strong>Do</strong> draw your graphics relative to their own origin and then move the object. <strong>Don&#39;t</strong> try to draw it directly on the screen position you want</p>
</blockquote>

<p>This class allows you to make primitive drawings like rectangles, circles, and lines. It is really useful when you need masks, hitboxes, or want a simple graphic without needing a bitmap file. It also inherits from <code>Container</code>.<br>
<a href="https://pixijs.download/dev/docs/PIXI.Graphics.html">PixiJS Graphics API</a><br>
Methods and properties that you will use most frequently:  </p>

<ul>
<li><code>beginFill(...)</code> and <code>endFill()</code>: You mark the beginning and end of a fill. Every shape you draw between the <em>begin</em> and <em>end</em> calls will be filled by the color you specify.</li>
<li><code>lineStyle(...)</code>: Defines color, thickness, and other properties of the line of your drawings.</li>
<li><code>moveTo(...)</code>, <code>lineTo(...)</code>, <code>drawRect(...)</code> and <code>drawCircle(...)</code>: The most basics tools for drawing. There are more complex ones like polygons and beziers! Check them out in the API.</li>
<li><code>clear()</code>: for when you need to erase everything and start over.</li>
</ul>

<aside class="warning">
A final note for graphics, because I've seen some... stuff: Don't try to <code>clear()</code> and then redraw all your <code>Graphics</code> every frame when you need to move it! You should ideally draw them once and then move, (scale, rotate, etc) the resulting object.
</aside>
<h2 id='text'>Text</h2>
<blockquote>
<p>Check <a href="https://pixijs.io/pixi-text-style">PixiJS Textstyle Editor</a> to make the textstyle easily.</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">styly</span><span class="p">:</span> <span class="nx">TextStyle</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TextStyle</span><span class="p">({</span>
    <span class="na">align</span><span class="p">:</span> <span class="dl">"</span><span class="s2">center</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">fill</span><span class="p">:</span> <span class="dl">"</span><span class="s2">#754c24</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">fontSize</span><span class="p">:</span> <span class="mi">42</span>
<span class="p">});</span>
<span class="kd">const</span> <span class="nx">texty</span><span class="p">:</span> <span class="nx">Text</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Text</span><span class="p">(</span><span class="dl">'</span><span class="s1">私に気づいて先輩！</span><span class="dl">'</span><span class="p">,</span> <span class="nx">styly</span><span class="p">);</span> <span class="c1">// Text supports unicode!</span>
<span class="nx">texty</span><span class="p">.</span><span class="nx">text</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">This is expensive to change, please do not abuse</span><span class="dl">"</span><span class="p">;</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">stage</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">texty</span><span class="p">);</span>
</code></pre></div>
<blockquote>
<p>(Japanese text is optional, I used it just to show Unicode support)</p>
</blockquote>

<p>Oh boy, we could have an entire chapter dedicated to text but for now, just the basics.<br>
Text has AMAZING support for Unicode characters (as long as your chosen font supports it) and it is pretty consistent on how it looks across browsers.<br>
<a href="https://pixijs.download/dev/docs/PIXI.Text.html">PixiJS Text API</a><br>
Tips:  </p>

<ul>
<li>Go to <a href="https://pixijs.io/pixi-text-style">PixiJS Textstyle Editor</a> to make your text look exactly like you want it to.</li>
<li><code>text</code>: Contains the text to show. <strong>Changing this is expensive</strong>. If you need your text to change every frame (for example, a score) consider using <code>BitmapText</code></li>
<li>To use custom fonts you need to add them as webfonts to your webpage. If you know your <em>html-fu</em> you can do this or you can check the <a href="#recipe-preloading-assets">fonts section on how to load assets</a></li>
</ul>
<h2 id='bitmaptext'>BitmapText</h2>
<blockquote>
<p><a href="https://pixijs.io/pixi-text-style">PixiJS Textstyle Editor</a> can be used to make the object for the <code>BitmapFont.from(...)</code> thingy.</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="c1">// If you need to know, this is the expensive part. This creates the font atlas</span>
<span class="nx">BitmapFont</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">"</span><span class="s2">comic 32</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">fill</span><span class="p">:</span> <span class="dl">"</span><span class="s2">#ffffff</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// White, will be colored later</span>
    <span class="na">fontFamily</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Comic Sans MS</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">fontSize</span><span class="p">:</span> <span class="mi">32</span>
<span class="p">})</span>

<span class="c1">// Remember, this font only has letters and numbers. No commas or any other symbol.</span>
<span class="kd">const</span> <span class="nx">bitmapTexty</span><span class="p">:</span> <span class="nx">BitmapText</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BitmapText</span><span class="p">(</span><span class="dl">"</span><span class="s2">I love baking, my family, and my friends</span><span class="dl">"</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="na">fontName</span><span class="p">:</span> <span class="dl">"</span><span class="s2">comic 32</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">fontSize</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span> <span class="c1">// Making it too big or too small will look bad</span>
        <span class="na">tint</span><span class="p">:</span> <span class="mh">0xFF0000</span> <span class="c1">// Here we make it red.</span>
    <span class="p">});</span>

<span class="nx">bitmapTexty</span><span class="p">.</span><span class="nx">text</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">This is cheap</span><span class="dl">"</span><span class="p">;</span>
<span class="nx">bitmapTexty</span><span class="p">.</span><span class="nx">text</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Change it as much as you want</span><span class="dl">"</span><span class="p">;</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">stage</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">bitmapTexty</span><span class="p">);</span>
</code></pre></div>
<blockquote>
<p>Remember, symbols won&#39;t show by default. Your sentence might not mean the same without commas.</p>
</blockquote>

<p>The faster but more limited brother to <code>Text</code>, BitmapText uses a BitmapFont to draw your text. That means that changing your text is just changing what sprites are shown on screen, which is really fast. Its downside is that if you need full Unicode support (Chinese, Japanese, Arabic, Russian, etc) you will end up with a font atlas so big that performance will start to go down again.<br>
<a href="https://pixijs.download/dev/docs/PIXI.BitmapText.html">PixiJS BitmapText API</a><br>
Tips:  </p>

<ul>
<li><strong>PixiJS can create a BitmapFont on the fly from a regular font.</strong> <code>BitmapFont.from(...)</code> will take an object similar to a TextStyle and make a font for you to use!

<ul>
<li>You will give this generated font a <code>name</code> and that will be the unique identifier. Creating another font with the same name will overwrite that style!</li>
<li>I advise making the BitmapFont in white as you can tint it later with the BitmapText object.</li>
<li>When creating a font this way, you can pass a custom set of characters to include in the BitmapFont atlas. <code>BitmapFont.ALPHA</code>, <code>BitmapFont.NUMERIC</code>, and <code>BitmapFont.ALPHANUMERIC</code> are constants you can use or you can create your own string.</li>
</ul></li>
<li>The screen size of the BitmapText is achieved by scaling the BitmapFont. This can lead to ugly-looking text if you are pushing your sizes too far apart. Try creating fonts that are closer in size to your needs.</li>
</ul>
<h2 id='filters'>Filters</h2>
<p><em>Stunning effects with no effort!</em></p>

<p>PixiJS has a stunning collection of filters and effects you can apply either to only one <em>DisplayObject</em> or to any <em>Container</em> and it will apply to all its children!
I won&#39;t cover <strong>all</strong> the filters (at the time of writing there are 37 of them!!) instead, I will show you how to use one of the pre-packaged filters and you will have to extrapolate the knowledge from there.<br>
<a href="http://filters.pixijs.download/dev/demo/index.html">You can see a demo of the filters</a> or <a href="https://github.com/pixijs/filters">go directly to Github to see what package to install</a>.  </p>

<blockquote>
<p>Creating and using filters is so easy that I wasn&#39;t sure if I needed to make this part or not</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="c1">// import the filters</span>
<span class="c1">// If you are using pixijs &lt; 6 you might need to import `filters`</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">BlurFilter</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">pixi.js</span><span class="dl">"</span><span class="p">;</span> 

<span class="c1">// Make your filter</span>
<span class="kd">const</span> <span class="nx">myBlurFilter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BlurFilter</span><span class="p">();</span>

<span class="c1">// Add it to the `.filters` array of any DisplayObject</span>
<span class="nx">clampy</span><span class="p">.</span><span class="nx">filters</span> <span class="o">=</span> <span class="p">[</span><span class="nx">myBlurFilter</span><span class="p">];</span>
</code></pre></div>
<p>This is a section that I almost didn&#39;t make because using filters is super simple but I made it anyway so you guys know there is a huge list of filters ready to use.</p>

<p>In essence, create a filter, add it to the filters array of your display object, and you are done!</p>

<aside class="notice">
Technically applying a filter on a <code>Sprite</code> should be cheaper than applying it to a <code>Container</code> but I haven't made enough tests to be able to tell you for certain.
</aside>
<h2 id='particles'>Particles</h2>
<p><em>Make it rain</em></p>

<blockquote>
<p>Make sure you dropped your emitter.json somewhere inside your src folder</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">particleSettings</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../emitter.json</span><span class="dl">"</span><span class="p">;</span>


<span class="kd">const</span> <span class="nx">particleContainer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ParticleContainer</span><span class="p">();</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">stage</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">particleContainer</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">emitter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">particles</span><span class="p">.</span><span class="nx">Emitter</span><span class="p">(</span><span class="nx">particleContainer</span><span class="p">,</span> <span class="nx">Texture</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">"</span><span class="s2">particleTexture.png</span><span class="dl">"</span><span class="p">),</span> <span class="nx">particleSettings</span><span class="p">);</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">autoUpdate</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="c1">// If you keep it false, you have to update your particles yourself.</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">updateSpawnPos</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">emit</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</code></pre></div>
<p>For handling particles, PixiJS uses their own format and you need to install the library: <code>npm install pixi-particles</code> and you can create them using <a href="https://pixijs.io/pixi-particles-editor/">the Particle Designer</a></p>

<p>Once we have our particles looking good on the editor we download a <code>.json</code> file and we will feed the parsed object into the <code>Emitter</code> constructor along with a container for our particles (it can be any <code>Container</code> but if you have a lot of particles you might want a <code>ParticleContainer</code>), and the <code>Texture</code> (or an array of textures) you want your particles to use.</p>

<p>To make that <code>.json</code> into something usable we need to either load it with <code>Assets</code> or just add it as part of our source code and <code>import</code> it.</p>

<p>Methods and properties that you will use most frequently:  </p>

<ul>
<li><code>playOnce(...)</code>: Starts emitting particles and optionally calls a callback when particle emission is complete.</li>
<li><code>playOnceAndDestroy(...)</code>: Starts emitting particles, sets autoUpdate to true, and sets up the Emitter to destroy itself when particle emission is complete.</li>
<li><code>autoUpdate</code>: Enable or disable the automatic update.</li>
<li><code>update(seconds)</code>: If autoUpdate is false, you need to manually move the time forward. This method wants the time in <strong>seconds</strong>.</li>
<li><code>updateSpawnPos(...)</code>: Move your emitter around</li>
<li><code>resetPositionTracking()</code>: When you move your emitter, it will leave a trail behind itself. If you want to teleport it without a trail, call this method after setting the spawn position.</li>
</ul>
<h1 id='context'>Context</h1>
<p><em>whose grandma is it anyway?</em></p>

<blockquote>
<p>Hopefully an example will make it easier to see...</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="kd">class</span> <span class="nx">A</span> <span class="p">{</span>
    <span class="k">private</span> <span class="nx">myName</span><span class="p">:</span> <span class="kr">string</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">I am A</span><span class="dl">"</span><span class="p">;</span>
    <span class="k">public</span> <span class="nx">method</span><span class="p">:</span> <span class="nb">Function</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nx">B</span> <span class="p">{</span>
    <span class="k">private</span> <span class="nx">myName</span><span class="p">:</span> <span class="kr">string</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">I am B</span><span class="dl">"</span><span class="p">;</span>

    <span class="k">public</span> <span class="nx">printName</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// Here... what does "this" means?!</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">myName</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">A</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">b</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">B</span><span class="p">();</span>

<span class="c1">// I assign a.method</span>
<span class="nx">a</span><span class="p">.</span><span class="nx">method</span> <span class="o">=</span> <span class="nx">b</span><span class="p">.</span><span class="nx">printName</span><span class="p">;</span>
<span class="nx">a</span><span class="p">.</span><span class="nx">method</span><span class="p">();</span> <span class="c1">// This will print "I am A"</span>
<span class="nx">b</span><span class="p">.</span><span class="nx">printName</span><span class="p">();</span> <span class="c1">// This will print "I am B"</span>

<span class="c1">// This will create a new function where `b` is the `this` for that function</span>
<span class="nx">a</span><span class="p">.</span><span class="nx">method</span> <span class="o">=</span> <span class="nx">b</span><span class="p">.</span><span class="nx">printName</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span>
<span class="nx">a</span><span class="p">.</span><span class="nx">method</span><span class="p">();</span> <span class="c1">// This now prints "I am B"</span>
</code></pre></div>
<blockquote>
<p>They are calling the same method... and getting different results!?</p>
</blockquote>

<p>Imagine you have a phone number that calls your grandma <em>Esther</em>. Let&#39;s say that this number is <code>555-1234</code>. When <strong>you</strong> dial <code>555-1234</code> you call <strong>your</strong> grandma.<br>
Now you dictate me the number, <code>555-1234</code> and <strong>I</strong> dial, it calls <strong>my</strong> grandma <em>Rachel</em>... Wait what?!<br>
We saw a moment ago that to reference a method or member of a class we need to prepend the <code>this.</code> keyword. In javascript, the <code>this</code> object, will become &quot;whoever owns the function&quot; (the context of who and where called the function).<br>
So when you need to pass a method as a parameter (let&#39;s call it <code>b.printName</code>), when that function parameter gets called, inside the code of that function, <code>this</code> is not <code>b</code>!
To fix this, you need to tell the function to <code>bind</code> (attach) the <code>this</code> (context) object. This is done by adding <code>.bind(b)</code> to the function like so: <code>b.printName.bind(b)</code><br>
Back to the telephone example, for <strong>me</strong> to call <strong>your</strong> grandma <em>Esther</em> you give me <code>555-1234.bind(estherGrandson)</code> and that makes it so that when I use the number, it understands that the original owner it&#39;s you and thus calls your grandma <em>Esther</em>.</p>

<p>This might make no sense now but you will start seeing a lot of <code>.bind()</code> in future chapters and this is the primer.</p>

<p>If you want a more formal explanation with fewer grandmas, you can try <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/this">MDN webdocs</a></p>

<aside class="notice">
PixiJS events also have another way to bind the context. It will be most likely a parameter of the method that requests a function. Setting either will work, no need to set it both ways.
</aside>
<h1 id='splitting-code'>Splitting code</h1>
<p><em>it&#39;s not me, it&#39;s you</em></p>

<p>We have been dumping all our code directly into  <code>index.ts</code> and this is all fine and dandy for quick tests and learning stuff but if we are going to move forward we need to learn how to split up our codebase into different files.  </p>
<h2 id='a-quick-preview-of-scenes'>A quick preview of Scenes</h2>
<blockquote>
<p>This is my <code>Scene.ts</code> file</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Container</span><span class="p">,</span> <span class="nx">Sprite</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">pixi.js</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">Scene</span> <span class="kd">extends</span> <span class="nx">Container</span> <span class="p">{</span>
    <span class="k">private</span> <span class="k">readonly</span> <span class="nx">screenWidth</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="k">private</span> <span class="k">readonly</span> <span class="nx">screenHeight</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>

    <span class="c1">// We promoted clampy to a member of the class</span>
    <span class="k">private</span> <span class="nx">clampy</span><span class="p">:</span> <span class="nx">Sprite</span><span class="p">;</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">screenWidth</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span> <span class="nx">screenHeight</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">();</span> <span class="c1">// Mandatory! This calls the superclass constructor.</span>

        <span class="c1">// see how members of the class need `this.`?</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">screenWidth</span> <span class="o">=</span> <span class="nx">screenWidth</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">screenHeight</span> <span class="o">=</span> <span class="nx">screenHeight</span><span class="p">;</span>

        <span class="c1">// Now clampy is a class member, we will be able to use it in another methods!</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span> <span class="o">=</span> <span class="nx">Sprite</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">"</span><span class="s2">clampy.png</span><span class="dl">"</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">anchor</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="mf">0.5</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">screenWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">screenHeight</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>In a future chapter I will <a href="#recipe-scene-manager">provide an example of my scene management system</a> but for now, let&#39;s start by making a class that inherits from Container and that will be the lifecycle of our examples and demos. This will allow us to have methods that come from an object instead of being global functions.<br>
Start by creating a new <code>.ts</code> file and create a class that extends <code>Container</code>. In my case, I created <code>Scene.ts</code> and created the <code>Scene</code> class. (I like to name my files with the same name as my class and to keep my classes starting with an uppercase).<br>
See the <code>export</code> keyword? In this wacky modular world, other files can only see what you export.<br>
And in the constructor of this new class, let&#39;s dump the code of our getting started.</p>

<aside class="warning">
See how I passed the screen size as a parameter to the constructor and stored it into a variable? That is to avoid "asking up" in my mental map of classes. A class should only know classes below itself. If you are going to need globally available stuff, try to limit it to avoid spaghetti code.
</aside>

<blockquote>
<p>And this is how my <code>index.ts</code> looks now</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Application</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">pixi.js</span><span class="dl">'</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Scene</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./scenes/Scene</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// This is the import statement</span>

<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Application</span><span class="p">({</span>
    <span class="na">view</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">pixi-canvas</span><span class="dl">"</span><span class="p">)</span> <span class="k">as</span> <span class="nx">HTMLCanvasElement</span><span class="p">,</span>
    <span class="na">resolution</span><span class="p">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">devicePixelRatio</span> <span class="o">||</span> <span class="mi">1</span><span class="p">,</span>
    <span class="na">autoDensity</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">backgroundColor</span><span class="p">:</span> <span class="mh">0x6495ed</span><span class="p">,</span>
    <span class="na">width</span><span class="p">:</span> <span class="mi">640</span><span class="p">,</span>
    <span class="na">height</span><span class="p">:</span> <span class="mi">480</span>
<span class="p">});</span>

<span class="c1">// pass in the screen size to avoid "asking up"</span>
<span class="kd">const</span> <span class="nx">sceny</span><span class="p">:</span> <span class="nx">Scene</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Scene</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">screen</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">app</span><span class="p">.</span><span class="nx">screen</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">stage</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">sceny</span><span class="p">)</span>
</code></pre></div>
<p>Finally, let&#39;s go back to the <code>index.ts</code> file and create and add to the screen a new <code>Scene</code> instance!<br>
First, we will need to import it, Visual Studio Code usually can suggest you the import path, otherwise you just <code>import</code> it with curly braces and the relative or absolute path of the file.</p>

<aside class="notice">
The curly braces in the import are there because a single file can export many classes or functions. However, unless you are exporting a class and helper functions or structures, I would strongly advise against having more than one class per file.
</aside>

<p>From now on, the examples will show you &quot;scenes&quot; instead of raw code to plaster in your <code>index.ts</code>. You have been warned.</p>
<h1 id='animating-stuff'>Animating stuff</h1>
<p><em>shake it baby!</em></p>

<p>Let&#39;s sum it up quickly, we have 3 main ways of animating stuff:</p>

<ul>
<li><strong>Animated Sprites</strong>: Frame-by-frame animations made out of multiple textures.</li>
<li><strong>Ticker and some Kinematic equations</strong>: During each frame, we check the speed of something and move it accordingly.</li>
<li><strong>Tweens</strong>: Short for &quot;in-betweens&quot;, it&#39;s a way of telling an object &quot;go to that place in this many seconds&quot; and have it go without having to think the physics.</li>
</ul>

<p>There is another kind of animations called bone animation and while there are PixiJS plugins for loading two of the biggest formats out there, Spine and DragonBones, we won&#39;t be seeing them here.</p>
<h2 id='animatedsprite'>AnimatedSprite</h2>
<blockquote>
<p>Don&#39;t freak out, we will use some javascripty stuff.</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">AnimatedSprite</span><span class="p">,</span> <span class="nx">Container</span><span class="p">,</span> <span class="nx">Texture</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">pixi.js</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">Scene</span> <span class="kd">extends</span> <span class="nx">Container</span> <span class="p">{</span>
    <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">();</span>

        <span class="c1">// This is an array of strings, we need an array of Texture</span>
        <span class="kd">const</span> <span class="nx">clampyFrames</span><span class="p">:</span> <span class="nb">Array</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">[</span>
          <span class="dl">"</span><span class="s2">clampy_sequence_01.png</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">clampy_sequence_02.png</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">clampy_sequence_03.png</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">clampy_sequence_04.png</span><span class="dl">"</span>
        <span class="p">];</span>

        <span class="c1">// `array.map()` creates an array from another array by doing something to each element.</span>
        <span class="c1">// `(stringy) =&gt; Texture.from(stringy)` means</span>
        <span class="c1">// "A function that takes a string and returns a Texture.from(that String)"</span>
        <span class="kd">const</span> <span class="nx">animatedClampy</span><span class="p">:</span> <span class="nx">AnimatedSprite</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AnimatedSprite</span><span class="p">(</span><span class="nx">clampyFrames</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">stringy</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">Texture</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="nx">stringy</span><span class="p">)));</span>
        <span class="c1">// (if this javascript is too much, you can do a simple for loop and create a new array with Texture.from())</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">animatedClampy</span><span class="p">);</span> <span class="c1">// we just add it to the scene</span>

        <span class="c1">// Now... what did we learn about assigning functions...</span>
        <span class="nx">animatedClampy</span><span class="p">.</span><span class="nx">onFrameChange</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">onClampyFrameChange</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="nx">onClampyFrameChange</span><span class="p">(</span><span class="nx">currentFrame</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Clampy's current frame is</span><span class="dl">"</span><span class="p">,</span> <span class="nx">currentFrame</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<blockquote>
<p>Clampy sequence assets don&#39;t exist. I lied to you. You will need your own assets.</p>
</blockquote>

<p>Frame-by-frame animations go with 2d games like toe and dirt. Animated sprite has got your back. (This inherits from <code>Sprite</code>)<br>
<a href="https://pixijs.download/dev/docs/PIXI.AnimatedSprite.html">PixiJS AnimatedSprite API</a><br>
Tips and stuff:</p>

<ul>
<li>You make this by passing an array of <code>Texture</code> objects.

<ul>
<li>A good way to do this is by loading a spritesheet directly. We will touch that on the <a href="#recipe-preloading-assets">loader recipe</a>.</li>
</ul></li>
<li>The constructor has a parameter <code>autoUpdate</code> that comes by default on true.

<ul>
<li>If you set it to false, you need to use <code>.update(...)</code> manually.</li>
</ul></li>
<li>A bunch of things that do exactly what they say...

<ul>
<li><code>.loop</code></li>
<li><code>.currentFrame</code></li>
<li><code>.playing</code></li>
<li><code>.play()</code>, <code>.stop()</code>, <code>.gotoAndPlay()</code> and <code>.gotoAndStop()</code></li>
</ul></li>
<li><code>.onFrameChange</code>: Assign a function to this and it will get called every time the frame changes.

<ul>
<li>It receives the <code>currentFrame</code> as a parameter, use it to call your functions at the exact frame!</li>
</ul></li>
</ul>
<h2 id='ticker'>Ticker</h2>
<p><em>Trigger warning: some math ahead</em></p>

<blockquote>
<p>Try to read a bit into the math before jumping into this one</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Container</span><span class="p">,</span> <span class="nx">Sprite</span><span class="p">,</span> <span class="nx">Ticker</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">pixi.js</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">Scene</span> <span class="kd">extends</span> <span class="nx">Container</span> <span class="p">{</span>
    <span class="k">private</span> <span class="k">readonly</span> <span class="nx">screenWidth</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="k">private</span> <span class="k">readonly</span> <span class="nx">screenHeight</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>

    <span class="k">private</span> <span class="nx">clampy</span><span class="p">:</span> <span class="nx">Sprite</span><span class="p">;</span>
    <span class="k">private</span> <span class="nx">clampyVelocity</span><span class="p">:</span> <span class="kr">number</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">screenWidth</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span> <span class="nx">screenHeight</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">();</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">screenWidth</span> <span class="o">=</span> <span class="nx">screenWidth</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">screenHeight</span> <span class="o">=</span> <span class="nx">screenHeight</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span> <span class="o">=</span> <span class="nx">Sprite</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">"</span><span class="s2">clampy.png</span><span class="dl">"</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">anchor</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="mf">0.5</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// we start it at 0</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">screenHeight</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">);</span>

        <span class="c1">// See the `, this` thingy there? That is another way of binding the context!</span>
        <span class="nx">Ticker</span><span class="p">.</span><span class="nx">shared</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>

        <span class="c1">// If you want, you can do it the bind way</span>
        <span class="c1">// Ticker.shared.add(this.update.bind(this)); </span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="nx">update</span><span class="p">(</span><span class="nx">deltaTime</span><span class="p">:</span> <span class="kr">number</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">clampyVelocity</span> <span class="o">*</span> <span class="nx">deltaTime</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">x</span> <span class="o">&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">screenWidth</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Woah there clampy, come back inside the screen!</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Ok, PixiJS <code>Ticker</code> is an object that will call a function every frame before rendering and tell you how much time has passed since the last frame.<br>
But why is that useful? Well, when we know the velocity of something and we know for how long it has been moving we can predict where the object would be!  </p>

<p>In a silly example: If I know you can walk one block in 5 minutes, I know that if 10 minutes have passed you should be two blocks away.</p>

<p>Now, the actual spooky math is:</p>

<p><code>New Position = Old Position + Velocity * Time Passed</code></p>

<p>We can use this math every single frame to move an object after we give it a velocity! (Sorry if this was very obvious for you.)</p>

<p>Now that we are on board on what we need to do, let&#39;s see how to use the PixiJS Ticker.<br>
You can create one for yourself or just use the <code>Ticker.shared</code> instance that is already created for quick use. You just attach a function you want to be called every frame with the <code>.add()</code> and that&#39;s it!
<a href="https://pixijs.download/dev/docs/PIXI.Ticker_.html">PixiJS Ticker API</a><br>
Tips and Tricks:</p>

<ul>
<li>If you make your own <code>Ticker</code>, remember to <code>start()</code> it.</li>
<li>The function you give in <code>.add(...)</code> can have a parameter time.

<ul>
<li>That parameter is a number in &quot;how many frames passed at 60fps&quot;. So 1 means you are running at 60 fps. 2 means you are running at 30fps.</li>
<li>I personally hate it.</li>
</ul></li>
<li><code>.deltaMS</code> and <code>.elapsedMS</code> will give you the amounts of milliseconds that passed between each call. <code>elapsedMS</code> is raw milliseconds while <code>deltaMS</code> can get affected by timescales or max framerates.</li>
<li><code>.FPS</code> good place to ask how many fps are you getting right now.</li>
</ul>

<hr>
<h2 id='tweens'>Tweens</h2>
<blockquote>
<p>We will use my own creation, Tweedle.js you can get it by <code>npm install tweedle.js</code></p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Tween</span><span class="p">,</span> <span class="nx">Group</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">tweedle.js</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Container</span><span class="p">,</span> <span class="nx">Sprite</span><span class="p">,</span> <span class="nx">Ticker</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">pixi.js</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">Scene</span> <span class="kd">extends</span> <span class="nx">Container</span> <span class="p">{</span>
    <span class="k">private</span> <span class="nx">clampy</span><span class="p">:</span> <span class="nx">Sprite</span><span class="p">;</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">screenWidth</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span> <span class="nx">screenHeight</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">();</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span> <span class="o">=</span> <span class="nx">Sprite</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">"</span><span class="s2">clampy.png</span><span class="dl">"</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">anchor</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="mf">0.5</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">screenWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">screenHeight</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">);</span>

        <span class="nx">Ticker</span><span class="p">.</span><span class="nx">shared</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>

        <span class="c1">// See how these chains all together</span>
        <span class="k">new</span> <span class="nx">Tween</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">scale</span><span class="p">).</span><span class="nx">to</span><span class="p">({</span> <span class="na">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="mf">0.5</span> <span class="p">},</span> <span class="mi">1000</span><span class="p">).</span><span class="nx">repeat</span><span class="p">(</span><span class="kc">Infinity</span><span class="p">).</span><span class="nx">yoyo</span><span class="p">(</span><span class="kc">true</span><span class="p">).</span><span class="nx">start</span><span class="p">();</span>

        <span class="c1">// This is the same code, but unchained</span>
        <span class="c1">// const tweeny = new Tween(this.clampy.scale);</span>
        <span class="c1">// tweeny.to({ x: 0.5, y: 0.5 }, 1000);</span>
        <span class="c1">// tweeny.repeat(Infinity);</span>
        <span class="c1">// tweeny.yoyo(true);</span>
        <span class="c1">// tweeny.start();</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="nx">update</span><span class="p">():</span> <span class="k">void</span> <span class="p">{</span>
        <span class="c1">//You need to update a group for the tweens to do something!</span>
        <span class="nx">Group</span><span class="p">.</span><span class="nx">shared</span><span class="p">.</span><span class="nx">update</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<blockquote>
<p>Note that you will still some ticker or loop to update the tweens</p>
</blockquote>

<p>Ok, doing the math to move something with a given speed is fun and all, but what if I just want my element to do something in a certain amount of time and not bother to check if it already arrived, that it doesn&#39;t overshoot? To make it worse, what if I want some elastic moving movement?  </p>

<p>Tweens to the rescue! For tweens, I&#39;ll be using <a href="https://github.com/miltoncandelero/tweedle.js">Tweedle.js</a> which is what I use every day in my job and it&#39;s my own fork of tween.js.<br>
Just like with PixiJS API, I won&#39;t copypaste the full API, feel free to check the <a href="https://miltoncandelero.github.io/tweedle.js/">full Tweedle.js API Docs</a>  </p>

<p>Before we start, you need to remember <strong>You need to update tweens too!</strong>. This is usually achieved by updating the tween group they belong to. If you don&#39;t want to handle groups you can just use the shared static one that lives in <code>Group.shared</code>, just remember to update it.</p>

<p>Let&#39;s move through some of the basics:</p>

<ul>
<li>Create a tween with <code>new Tween(objectToChange);</code>

<ul>
<li>A second parameter can be passed if you want to use your custom groups, otherwise a shared static group that lives in <code>Group.shared</code> will be used.</li>
</ul></li>
<li>Tell your tween the target and duration with <code>.to( { property : targetValue }, duration)</code>

<ul>
<li>All durations of Tweedle are in <strong>Milliseconds</strong></li>
</ul></li>
<li>Once you are ready to let it rip, just call <code>.start()</code></li>
</ul>

<p>Ok, but what other cool things can Tweedle do?</p>

<ul>
<li>Repeat your movement with <code>.repeat(amountOfTimesToRepeat)</code>

<ul>
<li>When repeating, use <code>.yoyo(true)</code> to have the tween reverse on each loop so it goes back and forth</li>
</ul></li>
<li>Spice up your movement with <code>.easing(Easing.Elastic.Out)</code>

<ul>
<li>There are a <a href="https://miltoncandelero.github.io/tweedle.js/globals.html#easing">lot of easings</a> to pick!</li>
</ul></li>
<li>You can use bezier curves or tween between colors, it is some advanced stuff but it can be done. It&#39;s all in the <a href="https://miltoncandelero.github.io/tweedle.js/globals.html#interpolation">Interpolation</a></li>
</ul>

<aside class="warning">
All durations of Tweedle are in <b>Milliseconds</b>
</aside>

<aside class="warning">
Remember to <code>.update()</code> your groups!
</aside>
<h1 id='getting-interactive'>Getting interactive</h1>
<p>In web HTML5 games we usually rely on 2 kinds of inputs: Some sort of pointing device (be it a mouse or a touchscreen) and the keyboard.  </p>

<p>We will explore how to use both of them and then we will do a quick overview on how you can trigger some of your own custom events.</p>

<p>--</p>
<h2 id='pointer-events'>Pointer Events</h2>
<p><em>mouse... touch.... both?</em></p>
<div class="highlight"><pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Container</span><span class="p">,</span> <span class="nx">FederatedPointerEvent</span><span class="p">,</span> <span class="nx">Sprite</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">pixi.js</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">Scene</span> <span class="kd">extends</span> <span class="nx">Container</span> <span class="p">{</span>
    <span class="k">private</span> <span class="nx">clampy</span><span class="p">:</span> <span class="nx">Sprite</span><span class="p">;</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">screenWidth</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span> <span class="nx">screenHeight</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">();</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span> <span class="o">=</span> <span class="nx">Sprite</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">"</span><span class="s2">clampy.png</span><span class="dl">"</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">anchor</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="mf">0.5</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">screenWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">screenHeight</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">);</span>

        <span class="c1">// events that begin with "pointer" are touch + mouse</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">"</span><span class="s2">pointertap</span><span class="dl">"</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">onClicky</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>

        <span class="c1">// This only works with a mouse</span>
        <span class="c1">// this.clampy.on("click", this.onClicky, this);</span>

        <span class="c1">// This only work with touch</span>
        <span class="c1">// this.clampy.on("tap", this.onClicky, this);</span>

        <span class="c1">// Super important or the object will never receive mouse events!</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">interactive</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="nx">onClicky</span><span class="p">(</span><span class="nx">e</span><span class="p">:</span> <span class="nx">FederatedPointerEvent</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">You interacted with Clampy!</span><span class="dl">"</span><span class="p">)</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">The data of your interaction is super interesting</span><span class="dl">"</span><span class="p">,</span> <span class="nx">e</span><span class="p">)</span>

        <span class="c1">// Global position of the interaction</span>
        <span class="c1">// e.global</span>

        <span class="c1">// Local (inside clampy) position of the interaction</span>
        <span class="c1">// clampy.toLocal(e.global)</span>
        <span class="c1">// or the "unsafe" way:</span>
        <span class="c1">// (e.target as DisplayObject).toLocal(e.global)</span>
        <span class="c1">// Remember Clampy has the 0,0 in its center because we set the anchor to 0.5!</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>PixiJS has a <em>thing</em> that whenever you click or move your mouse on the screen it checks what object were you on, no matter how deep in the display list that object is, and lets it know that <em>a mouse</em> happened.<br>
(If curious, that <em>thing</em> is a plugin called <a href="https://pixijs.download/dev/docs/PIXI.EventSystem.html">Federated Events System</a>)  </p>

<p>The basic anatomy of adding an event listener to an imput is:<br>
<code>yourObject.on(&quot;stringOfWhatYouWantToKnow&quot;, functionToBeCalled, contextForTheFunction)</code></p>

<p>and the second super important thing is:<br>
<code>yourObject.interactive = true</code></p>
<h3 id='touch-mouse-i-want-it-all'>Touch? Mouse? I want it all!</h3>
<p>The web has moved forward since its first inception and now we have mouses and touchscreens!<br>
Here is a small list of the most useful events with their mouse, touch, and catch-all variants.<br>
The rule of thumb is that if it has <code>pointer</code> in the name, it will catch both mouse and touch.  </p>

<table><thead>
<tr>
<th>Mouse only</th>
<th>Touch only</th>
<th>Mouse + Touch</th>
</tr>
</thead><tbody>
<tr>
<td><code>click</code></td>
<td><code>tap</code></td>
<td><code>pointertap</code></td>
</tr>
<tr>
<td><code>mousedown</code></td>
<td><code>touchstart</code></td>
<td><code>pointerdown</code></td>
</tr>
<tr>
<td><code>mouseup</code></td>
<td><code>touchend</code></td>
<td><code>pointerup</code></td>
</tr>
<tr>
<td><code>mousemove</code></td>
<td><code>touchmove</code></td>
<td><code>pointermove</code></td>
</tr>
</tbody></table>

<aside class="warning">Still not working? You forgot the <code>.interactive = true</code>, didn't you?</aside>
<h3 id='the-event-that-fired'>The event that fired</h3>
<p>When your function gets called you will also receive a parameter, that is all the data that event produced. You can see the <a href="https://pixijs.download/dev/docs/PIXI.FederatedPointerEvent.html">full shape of the object here</a>.<br>
I will list now some of the most common properties here now:  </p>

<ul>
<li><code>event.global</code> This is the global (stage) position of the interaction</li>
<li><code>(e.target as DisplayObject).toLocal(e.global)</code> This is the local (object that has the event) position of the interaction. It has an unsafe cast due to the new Event System being a bit paranoid.</li>
<li><code>event.pointerType</code> This will say <code>mouse</code> or <code>touch</code></li>
</ul>
<h3 id='old-magical-stuff-pre-pixijs-v7'>Old Magical stuff (pre PixiJS v7)</h3>
<p>You might have come across by the fact that if you have a function that is called exactly the same as an event (for example a <code>click</code> function) and your object is interactive, that function gets called automagically.<br>
That was because there is a line inside the old <a href="https://pixijs.download/v6.5.8/docs/packages_interaction_src_InteractionManager.ts.html">Interaction Manager&#39;s</a> that if it finds that a display object has a method with the same name as an event it calls it.</p>

<p><strong>This was removed on PixiJS&#39; v7 new <a href="https://pixijs.download/dev/docs/PIXI.EventSystem.html">Federated Events System</a></strong></p>

<p>--</p>
<h2 id='keyboard'>Keyboard</h2><div class="highlight"><pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Container</span><span class="p">,</span> <span class="nx">Sprite</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">pixi.js</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">Scene</span> <span class="kd">extends</span> <span class="nx">Container</span> <span class="p">{</span>
    <span class="k">private</span> <span class="nx">clampy</span><span class="p">:</span> <span class="nx">Sprite</span><span class="p">;</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">screenWidth</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span> <span class="nx">screenHeight</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">();</span>

        <span class="c1">// Clampy has nothing to do here, but I couldn't left it outside, poor thing</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span> <span class="o">=</span> <span class="nx">Sprite</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">"</span><span class="s2">clampy.png</span><span class="dl">"</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">anchor</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="mf">0.5</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">screenWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">screenHeight</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">);</span>

        <span class="c1">// No pixi here, All HTML DOM baby!</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">keydown</span><span class="dl">"</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">onKeyDown</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">keyup</span><span class="dl">"</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">onKeyUp</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="nx">onKeyDown</span><span class="p">(</span><span class="nx">e</span><span class="p">:</span> <span class="nx">KeyboardEvent</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">KeyDown event fired!</span><span class="dl">"</span><span class="p">,</span> <span class="nx">e</span><span class="p">);</span>

        <span class="c1">// Most likely, you will switch on this:</span>
        <span class="c1">// e.code // if you care about the physical location of the key</span>
        <span class="c1">// e.key // if you care about the character that the key represents</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="nx">onKeyUp</span><span class="p">(</span><span class="nx">e</span><span class="p">:</span> <span class="nx">KeyboardEvent</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">KeyUp event fired!</span><span class="dl">"</span><span class="p">,</span> <span class="nx">e</span><span class="p">);</span>

        <span class="c1">// Most likely, you will switch on this:</span>
        <span class="c1">// e.code // if you care about the physical location of the key</span>
        <span class="c1">// e.key // if you care about the character that the key represents</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>And here is where PixiJS lets go of our hands and we have to grow up and use the DOM.</p>

<p>Luckily, the DOM was meant to use keyboards and we have two big events: <code>keydown</code> and <code>keyup</code>. The bad news is that this detects <strong>ALL</strong> keypresses, <strong>ALL</strong> the time. </p>

<p>To solve <em>which</em> key was pressed at any point in time, we have two string properties on the keyboard event: <em>code</em> and <em>key</em>.  </p>
<h3 id='key'>key</h3>
<p><code>key</code> is the easiest one to explain because it is a string that shows what character should be printed into a textbox after the user presses a key. It follows the user keyboard layout and language so if you need the user to write some text, this is the ideal property.</p>
<h3 id='code'>code</h3>
<p><code>code</code> might be confusing at first, but let me tell you bluntly: Not everybody uses QWERTY keyboards. AZERTY and DVORAK keyboards are a thing (and we are not even getting into right to left keyboards) so if you bind your character jumping to the <code>Z</code> <em>key</em> you might find out later that not everybody has it in the same place in their keyboard distributions!<br>
For problems like this, <code>code</code> was born. It represents a physical location in a keyboard so you can confidently ask for the <code>Z</code> and <code>X</code> keyboard keys and they will be one next to the other no matter what language it is using.</p>

<aside class="info">To see the <code>key</code> and <code>code</code> for any key on your keyboard, check <a href="https://keycode.info/">this awesome website</a></aside>

<blockquote>
<p>Consider this a <code>Keyboard.ts</code> recipe:</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="kd">class</span> <span class="nx">Keyboard</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">readonly</span> <span class="nx">state</span><span class="p">:</span> <span class="nb">Map</span><span class="o">&lt;</span><span class="kr">string</span><span class="p">,</span> <span class="nx">boolean</span><span class="o">&gt;</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">static</span> <span class="nx">initialize</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// The `.bind(this)` here isn't necesary as these functions won't use `this`!</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">keydown</span><span class="dl">"</span><span class="p">,</span> <span class="nx">Keyboard</span><span class="p">.</span><span class="nx">keyDown</span><span class="p">);</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">keyup</span><span class="dl">"</span><span class="p">,</span> <span class="nx">Keyboard</span><span class="p">.</span><span class="nx">keyUp</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="k">static</span> <span class="nx">keyDown</span><span class="p">(</span><span class="nx">e</span><span class="p">:</span> <span class="nx">KeyboardEvent</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
        <span class="nx">Keyboard</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">code</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="k">static</span> <span class="nx">keyUp</span><span class="p">(</span><span class="nx">e</span><span class="p">:</span> <span class="nx">KeyboardEvent</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
        <span class="nx">Keyboard</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">code</span><span class="p">,</span> <span class="kc">false</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>But sometimes we need to know the <em>state</em> of a key: Is it pressed? To do this we need to keep track of this state of every key manually, luckily we can do it with a really simple static class.</p>

<p>We just need to once call the <code>Keyboard.initialize()</code> method to add the events and then we can ask <code>Keyboard.state.get(&quot;ArrowRight&quot;)</code> and if this says true then the key is down!</p>

<aside class="warning"> If you are an old school programmer you might recognize a <code>Map</code> object and try to access it with brackets notation: <code>Keyboard.state["ArrowRight"]</code>. However <b>this won't work with javascript maps!</b></aside>
<h3 id='keycode-which-keypress-are-deprecated'>keyCode, which, keypress are deprecated!</h3>
<aside class="warning"> If you are an old web programmer you might be tempted to fall back to your old <code>keyCode</code> or <code>which</code> and the <code>keypress</code> event, but those have been deprecated and you <b>shouldn't be using them.</b></aside>

<p>--</p>
<h2 id='making-custom-events-and-the-overall-syntax'>Making custom events and the overall syntax</h2>
<blockquote>
<p>All display objects are event emitters so we can create a sprite to test:</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">clampy</span><span class="p">:</span> <span class="nx">Sprite</span> <span class="o">=</span> <span class="nx">Sprite</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">"</span><span class="s2">clampy.png</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">clampy</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">"</span><span class="s2">clamp</span><span class="dl">"</span><span class="p">,</span> <span class="nx">onClampyClamp</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>

<span class="nx">clampy</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="dl">"</span><span class="s2">clamp</span><span class="dl">"</span><span class="p">,</span> <span class="nx">onClampyClampOnce</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>

<span class="c1">// clampy.off("clamp", onClampyClamp); // This will remove the event!</span>


<span class="c1">// somewhere, when the time is right... Fire the clamp!</span>
<span class="nx">clampy</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="dl">"</span><span class="s2">clamp</span><span class="dl">"</span><span class="p">);</span>


<span class="c1">// If you come from c++ this will mess you up: Functions can be declared after you used them.</span>
<span class="kd">function</span> <span class="nx">onClampyClamp</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">clampy did clamp!</span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">onClampyClampOnce</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">this will only be called once and then removed!</span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<blockquote>
<p>using <code>.off(...)</code> can be tricky. If you used <code>.bind(this)</code> then it will probably not work. That is why there is an extra parameter so you can provide the <code>this</code> context to the <code>on(...)</code> function!</p>
</blockquote>

<p>What do we do if we want to be notified when something happens? One way could be setting a boolean flag and looking at it at every update loop, waiting for it to change but this is clumsy and hard to read. Introducing Events!</p>

<p>An event is a way for an object to <em>emit</em> a scream into the air and for some other object to <em>listen</em> and react to this scream.<br>
For this purpose, PixiJS uses EventEmitter3.<br>
<a href="https://nodejs.org/api/events.html">The API is made to mirror the one found on node.js</a><br>
Let&#39;s see a quick overview of how EventEmitter3 works:  </p>

<ul>
<li><code>.on(...)</code>: Adds an event listener.</li>
<li><code>.once(...)</code>: Adds an event listener that will remove itself after it gets called once.</li>
<li><code>.off(...)</code>: Removes an event listener. (Tricky to use if you use <code>.bind</code>!)</li>
<li><code>.emit(...)</code>: Emits an event, all listeners for that event will get called.</li>
<li><code>.removeAllListeners()</code>: Removes all event listeners.</li>
</ul>

<aside class="warning">
An event listener will keep an object alive. Calling <code>.destroy()</code> will remove all listeners. Otherwise you need to call <code>.off(...)</code> for each event (or call <code>.removeAllListeners()</code>)
</aside>
<h1 id='collision-detection'>Collision detection</h1>
<p><em>Stop touching meeeeeeee</em></p>

<p>We know how to put things on screen, how to make them move under our control but now we need to know when they happen to be one on top of the other.<br>
To detect this we first need to understand a bit of math on how to know if two rectangles are overlapping, then we will see how to find <em>global rectangles</em> for our PixiJS objects.<br>
PixiJS has the <code>Rectangle</code> class and the <code>Bounds</code> class and then PixiJS <em>DisplayObjects</em> have a <code>getBounds()</code> method but it returns a <code>Rectangle</code> and not a <code>Bounds</code>. Please don&#39;t think too much about it.</p>
<h2 id='pure-rectangle-math'>Pure rectangle math</h2>
<blockquote>
<p>Here you have a snippet to check if two rectangles intersect</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="c1">// assume `a` and `b` are instances of Rectangle</span>
<span class="kd">const</span> <span class="nx">rightmostLeft</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">left</span> <span class="o">&lt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">left</span> <span class="p">?</span> <span class="nx">b</span><span class="p">.</span><span class="nx">left</span> <span class="p">:</span> <span class="nx">a</span><span class="p">.</span><span class="nx">left</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">leftmostRight</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">right</span> <span class="o">&gt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">right</span> <span class="p">?</span> <span class="nx">b</span><span class="p">.</span><span class="nx">right</span> <span class="p">:</span> <span class="nx">a</span><span class="p">.</span><span class="nx">right</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">leftmostRight</span> <span class="o">&lt;=</span> <span class="nx">rightmostLeft</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">bottommostTop</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">top</span> <span class="o">&lt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">top</span> <span class="p">?</span> <span class="nx">b</span><span class="p">.</span><span class="nx">top</span> <span class="p">:</span> <span class="nx">a</span><span class="p">.</span><span class="nx">top</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">topmostBottom</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">bottom</span> <span class="o">&gt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">bottom</span> <span class="p">?</span> <span class="nx">b</span><span class="p">.</span><span class="nx">bottom</span> <span class="p">:</span> <span class="nx">a</span><span class="p">.</span><span class="nx">bottom</span><span class="p">;</span>

<span class="k">return</span> <span class="nx">topmostBottom</span> <span class="o">&gt;</span> <span class="nx">bottommostTop</span><span class="p">;</span>
</code></pre></div>
<p>Ok, first I have to be honest with you, when I said <em>Rectangles</em> I exagerated. We will be working with <strong>Axis-aligned bounding boxes (AABB)</strong> and that means that the sides of our rectangles will always be parallel to one axis and perpendicular to the other. (In layman terms, no rotated rectangles here.)</p>

<p>With that out of the way let&#39;s see the naming, a rectangle has <code>x</code>, <code>y</code>, <code>width</code>, and <code>height</code>.<br>
They also have: 
- <code>top</code> which is equal to <code>y</code>
- <code>bottom</code> which is equal to <code>y + height</code>
- <code>left</code> which is equal to <code>x</code>
- <code>right</code> which is equal to <code>x + width</code></p>

<p>In our algorithm we now calculate (please read this slowly and thoroughly):
- <code>rightmostLeft</code>: Compare the <code>left</code> value of our two rectangles and pick the rightmost.
- <code>leftmostRight</code>: Compare the <code>right</code> value of our two rectangles and pick the leftmost.
- <code>bottommostTop</code>: Compare the <code>top</code> value of our two rectangles and pick the bottom-most.
- <code>topmostBottom</code>: Compare the <code>bottom</code> value of our two rectangles and pick the topmost.</p>

<p>If you think about it, I now have a new set of <code>left</code>, <code>right</code>, <code>top</code>, and <code>bottom</code> values.<br>
Here comes the magical part: <strong>if these values make sense, that is to say <code>left</code> is to the left of <code>right</code> AND <code>top</code> is above of <code>bottom</code> our initial rectangles are overlapping</strong>.<br>
As soon as one of the pairs doesn&#39;t make sense, we know those rectangles can not be overlapping.</p>

<aside class="info">
Fun fact: When those values make sense, the rectangle that forms is the <b>intersection</b> of your two rectangles! You can use that if you need to separate the rectangles.
</aside>
<h2 id='displayobjects-into-rectangles'>DisplayObjects into Rectangles</h2><div class="highlight"><pre class="highlight typescript"><code><span class="kd">function</span> <span class="nx">checkCollision</span><span class="p">(</span><span class="nx">objA</span><span class="p">:</span> <span class="nx">DisplayObject</span><span class="p">,</span> <span class="nx">objB</span><span class="p">:</span> <span class="nx">DisplayObject</span><span class="p">):</span> <span class="nx">boolean</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">objA</span><span class="p">.</span><span class="nx">getBounds</span><span class="p">();</span>
    <span class="kd">const</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">objB</span><span class="p">.</span><span class="nx">getBounds</span><span class="p">();</span>

    <span class="kd">const</span> <span class="nx">rightmostLeft</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">left</span> <span class="o">&lt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">left</span> <span class="p">?</span> <span class="nx">b</span><span class="p">.</span><span class="nx">left</span> <span class="p">:</span> <span class="nx">a</span><span class="p">.</span><span class="nx">left</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">leftmostRight</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">right</span> <span class="o">&gt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">right</span> <span class="p">?</span> <span class="nx">b</span><span class="p">.</span><span class="nx">right</span> <span class="p">:</span> <span class="nx">a</span><span class="p">.</span><span class="nx">right</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">leftmostRight</span> <span class="o">&lt;=</span> <span class="nx">rightmostLeft</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">const</span> <span class="nx">bottommostTop</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">top</span> <span class="o">&lt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">top</span> <span class="p">?</span> <span class="nx">b</span><span class="p">.</span><span class="nx">top</span> <span class="p">:</span> <span class="nx">a</span><span class="p">.</span><span class="nx">top</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">topmostBottom</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">bottom</span> <span class="o">&gt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">bottom</span> <span class="p">?</span> <span class="nx">b</span><span class="p">.</span><span class="nx">bottom</span> <span class="p">:</span> <span class="nx">a</span><span class="p">.</span><span class="nx">bottom</span><span class="p">;</span>

    <span class="k">return</span> <span class="nx">topmostBottom</span> <span class="o">&gt;</span> <span class="nx">bottommostTop</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>Ok, now that we know how to check if two rectangles overlap we just need to make rectangles out of PixiJS DisplayObjects, introducing <code>getBounds()</code><br>
The <em>bounds</em> of a DisplayObject is an axis-aligned bounding box and in the case of containers, this box contains inside all its children.<br>
The magic of this is that it works no matter how far apart are the DisplayObjects in the display tree because the method returns the <em>global</em> bounds of any object and that gives us a shared reference system for any pair of objects.</p>

<p>So, the logic is quite simple, we just need to <code>getBounds()</code> and then send them into the previous algorithm.</p>
<h2 id='a-note-on-colliding-polygons'>A note on colliding polygons.</h2>
<p>For colliding angled rectangles, polygons, and more information about how they collide you can use the <strong>separating axis theorem (SAT)</strong> that says: <em>Two convex objects do not overlap if there exists a line (called axis) onto which the two objects&#39; projections do not overlap.</em>  </p>

<p>However, the algorithm is not as trivial as the AABB one, and getting DisplayObjects to become polygonal shapes adds another layer of complexity.</p>

<p>I do have an implementation for this but it&#39;s not elegant and I don&#39;t feel confident in giving it for the world to use. One day I might write a more robust implementation and make it free to the public.</p>
<h1 id='sounding-good'>Sounding Good</h1>
<p><em>You and the marvelous world of sounds</em></p>

<p>To play sounds and music in our games we are going to use the <a href="https://github.com/pixijs/sound">PixiJS solution for sound</a>.<br>
Just like its rendering counterpart, PixiJS Sound hides away an implementation meant to work on every browser leveraging the WebAudio API giving us a simple-to-use interface with a lot of power under the hood.<br>
If you want a more in-depth demo you can check the <a href="https://pixijs.io/sound/examples/index.html">PixiJS Demo website</a>.</p>
<h2 id='playing-a-sound'>Playing a sound</h2><div class="highlight"><pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Container</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">pixi.js</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Sound</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@pixi/sound</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">Scene</span> <span class="kd">extends</span> <span class="nx">Container</span> <span class="p">{</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">screenWidth</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span> <span class="nx">screenHeight</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">();</span>

        <span class="c1">// Just like everything else, `from()` and then we are good to go</span>
        <span class="kd">const</span> <span class="nx">whistly</span> <span class="o">=</span> <span class="nx">Sound</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">"</span><span class="s2">whistle.mp3</span><span class="dl">"</span><span class="p">);</span>
        <span class="nx">whistly</span><span class="p">.</span><span class="nx">volume</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
        <span class="nx">whistly</span><span class="p">.</span><span class="nx">play</span><span class="p">();</span>

    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>If you reached this point making <code>Sprites</code> you will see the <code>Sound.from()</code> syntax and feel at home.<br>
You just create a sound object directly from a sound file URL and then you can tweak it and play it!<br>
Some helpful things inside a sound are:</p>

<ul>
<li><code>.play()</code>, <code>.stop()</code> and <code>.isPlaying</code></li>
<li><code>.pause()</code>, <code>.resume()</code> and <code>.paused</code></li>
<li><code>.volume</code> and <code>.muted</code></li>
<li><code>.loop</code></li>
<li><code>.filters</code> (this is a bit more advanced but you can achieve some really cool effects!)</li>
</ul>

<aside class="info">You think you did everything correctly but your sounds aren't playing? Tried clicking inside your game? Now they fired all at once and are working?  
This is due to a policy that started on Apple's Safari and then extended into all browsers where you can't play a sound without user interaction. To circumvent this, PixiJS Sound creates an invisible giant button to <b>unlock</b> your audio. After the user clicks once we can play all the sounds we want.  
<a href="https://developers.google.com/web/updates/2017/09/autoplay-policy-changes">For more information, Chrome's explanation is quite good.</a></aside>
<h1 id='recipes'>Recipes</h1>
<p>This is where the basics end and while PixiJS still have plenty of classes and utilities I haven&#39;t explained yet I think so far I have explained everything you need to build your own game and research further.<br>
That being said... there are some things I&#39;ve picked up along the way making games: Introducing <em>Recipes</em>.<br>
<em>Recipes</em> is going to be a way of providing you with the solutions to problems I have faced in my game-making career.</p>

<blockquote>
<p>These <em>Recipes</em> will have a lot of code, so this column will probably the star of the show...</p>
</blockquote>
<h1 id='recipe-preloading-assets'>Recipe: Preloading assets</h1>
<p>So far we have seen how to create images and sounds by downloading the asset behind them just as we need to show it to the user. While this is good enough if we want a quick way to make a proof of concept or prototype, it won&#39;t be good enough for a project release.<br>
The old and elegant way of doing it is downloading all the assets you are going to need beforehand and storing them in some sort of cache.<br>
However, times change and users now want everything ready <strong>right now!</strong> so instead of having one big load at the beginning we will aim to have the smaller download possible to make do and keep everything loading in the background and <em>hopefully</em> when the user reaches further into the game our assets will be ready.<br>
To this purpose, PixiJS includes <a href="https://pixijs.download/dev/docs/PIXI.Assets.html">Assets</a>: A system for your resource management needs. A promise-based, background-loading, webworker-using, format-detecting, juggernaut of a system.</p>

<p>In this recipe, we are going to create one of our <code>Scene</code> to load all the files we declare in a manifest object and then I will teach you how to recover the files from the <code>Assets</code> cache.</p>
<h2 id='first-of-all-a-primer-on-promises'>First of all, a primer on <em>Promises</em>.</h2>
<blockquote>
<p>use <code>.then(..)</code> to be notified when that value is ready</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="nx">somePromise</span><span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">myValue</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// This function will be called when "myValue" is ready to go!</span>
<span class="p">});</span>
</code></pre></div>
<p>A promise is something that <em>will eventually have a value</em> for you to use but you can&#39;t be sure if that value is ready or not just yet, so you ask nicely to be notified when that happens.<br>
When a Promise has your value, it is said that it <em>resolves</em> your value. For you to use the value you need to give a function to the <code>.then(...)</code> method.</p>

<blockquote>
<p>keep in mind that even resolved promises take a bit of time before executing your then, so take a look at this code...</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">before</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">alreadyResolvedPromise</span><span class="p">((</span><span class="nx">value</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">inside the then with my value</span><span class="dl">"</span><span class="p">,</span> <span class="nx">value</span><span class="p">);</span>
<span class="p">});</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">after</span><span class="dl">"</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>will give us: &quot;before&quot; -&gt; &quot;after&quot; -&gt; &quot;inside the then with my value&quot;.</p>
</blockquote>

<aside class="info">Even if the promise was resolved long ago, adding a <code>.then(...)</code> will trigger almost immediately, this means you don't have to <i>see it</i> resolve, you can come after it has resolved and it will still give you a value.</aside>
<h3 id='awaiting-promises'>Awaiting Promises</h3>
<blockquote>
<p>Take a look at this very naïve code...</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="c1">// async functions always return a Promise of whatever they return</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">waitForPromise</span><span class="p">()</span> <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="kr">string</span><span class="o">&gt;</span>
<span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">This starts excecuting</span><span class="dl">"</span><span class="p">);</span>

    <span class="c1">// As this next line has `await` in it, it will "freeze" the execution here until that magical promise resolves to a value.</span>
    <span class="kd">const</span> <span class="nx">magicalNumber</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">someMagicalPromise</span><span class="p">;</span>

    <span class="c1">// When the promise is resolved, our code keeps executing</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Wow, that took a while!</span><span class="dl">"</span><span class="p">);</span>

    <span class="c1">// We return a string with the resolved value... but that took some time, so the entire function actually returns a promise.</span>
    <span class="k">return</span> <span class="dl">"</span><span class="s2">This will be finally resolved! The Magical number was </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">magicalNumber</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span> 
<span class="p">}</span>

<span class="c1">// We kinda need to call the function, right?</span>
<span class="nx">waitForPromise</span><span class="p">();</span>
</code></pre></div>
<p>To keep code somewhat easier to read, you can use two keywords <code>async</code> and <code>await</code> to <em>freeze</em> the code until a promise resolves.<br>
This doesn&#39;t really change how Promises work, this is only <em>syntax sugar</em> that will be turned into the regular functions by the browser.  </p>

<aside class="warning">
Some rules about <code>async</code> and <code>await</code>:
<ul>
<li><code>await</code> can only be used inside an <code>async</code> function.</li>
<li>a Constructor can never be <code>async</code></li>
<li>try to avoid mixing <code>.then(...)</code> and <code>await</code> inside an <code>async</code> function if you can. It can get confusing very fast</li>
</ul>
</aside>
<h2 id='using-assets'>Using <em>Assets</em></h2>
<blockquote>
<p>Using <code>Assets.load(...)</code> with <code>.then(...)</code></p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="nx">Assets</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="dl">"</span><span class="s2">./clampy.png</span><span class="dl">"</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">clampyTexture</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">clampySprite</span> <span class="o">=</span> <span class="nx">Sprite</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="nx">clampyTexture</span><span class="p">);</span>
<span class="p">});</span>
<span class="c1">// Be careful, `clampySprite` doesn't exist out here, only inside those brackets!</span>
</code></pre></div>
<blockquote>
<p>Using <code>Assets.load(...)</code> with <code>async</code> <code>await</code></p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">loadClampy</span><span class="p">()</span> <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Sprite</span><span class="o">&gt;</span>
<span class="p">{</span>
    <span class="kd">const</span> <span class="nx">clampyTexture</span> <span class="o">=</span> <span class="nx">Assets</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="dl">"</span><span class="s2">./clampy.png</span><span class="dl">"</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">Sprite</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="nx">clampyTexture</span><span class="p">);</span>
<span class="p">}</span>
<span class="c1">// now calling `loadClampy()` will yield a Clampy sprite promise!</span>
</code></pre></div>
<p>Sometimes we just want to load one single file, quick and dirty. For that purpose we have <code>Assets.load(...)</code>.<br>
This will return a promise that will solve with the loaded and parsed asset ready to use! </p>

<aside class="info">Assets is a very smart piece of code and it will never download twice the same asset! Feel free to call <code>Assets.load(...)</code> every time you need an asset and it will give you the cached asset if it was already downloaded.</aside>
<h3 id='load-vs-get'>.load(...) vs .get(...)</h3>
<p><code>Assets</code> has two methods to get your asset from inside it. The safer <code>Assets.load(...)</code> that will return a promise and the unsafe <code>Assets.get(...)</code> that will just return your asset... or <code>undefined</code>.<br>
If you are <em>absolutely</em> sure that your asset has been loaded before and you don&#39;t want to deal with the promise that <code>Assets.load(...)</code> returns, you can use <code>Assets.get(...)</code> to get your asset directly from the cache, however if you were wrong and your asset wasn&#39;t loaded before you will get <code>undefined</code>.</p>
<h2 id='the-files-to-download-manifest'>The files-to-download Manifest.</h2>
<blockquote>
<p>Let&#39;s start with our <em>manifest</em> object. I will call this file <code>assets.ts</code> {manifest&#39;s entries can have many shapes, this is the one I like the most.}</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="k">import</span> <span class="kd">type</span> <span class="p">{</span> <span class="nx">ResolverManifest</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">pixi.js</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">manifest</span><span class="p">:</span><span class="nx">ResolverManifest</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">bundles</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="na">name</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">bundleName</span><span class="dl">"</span><span class="p">,</span>
            <span class="na">assets</span><span class="p">:</span>
            <span class="p">{</span>
                <span class="dl">"</span><span class="s2">Clampy the clamp</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">./clampy.png</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">another image</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">./monster.png</span><span class="dl">"</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="na">name</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">another bundle</span><span class="dl">"</span><span class="p">,</span>
            <span class="na">assets</span><span class="p">:</span>
            <span class="p">{</span>
                <span class="dl">"</span><span class="s2">whistle</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">./whistle.mp3</span><span class="dl">"</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">},</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<p>As javascript is unable to &quot;scan&quot; a directory and just load everything inside we need to add some sort of <em>manifest object</em> that lists all the files that we need to download. Conveniently, <code>Assets</code> has a format to feed <em>Asset Bundles</em> from a <em>manifest</em>.<br>
An <em>Asset Bundle</em> is just that, a group of assets that make sense for our game to download together, for example, you make an <em>bundle</em> for each screen of your game.<br>
Here we can see we are how we can declare (and export for outside use) an <em>Asset Bundle</em> with the format that <code>Assets</code> wants it.<br>
Each bundle has a <code>name</code> field and an object of <code>assets</code> where the <em>key</em> is the name for each asset and the <em>value</em> is the URL for it. (by starting with <code>./</code> we mean &quot;relative to our <em>index.html</em>&quot;).  </p>

<aside class="info">Remember that Assets never downloads the same asset twice so don't be afraid to put the same asset in two different bundles.</aside>
<h2 id='using-our-manifest'>Using our <em>Manifest</em></h2>
<blockquote>
<p>This is just a snippet of how to initialize <code>Assets</code>. After this, we will see how to make a full loader <code>Scene</code> and background loading.</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="c1">// remember the assets manifest we created before? You need to import it here</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">initializeLoader</span><span class="p">():</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span> <span class="c1">// This promise won't return any value, will just take time to finish.</span>
<span class="p">{</span>
    <span class="c1">// Make sure you don't use Assets before this or you will get a warning and it won't work!</span>
    <span class="k">await</span> <span class="nx">Assets</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span> <span class="na">manifest</span><span class="p">:</span> <span class="nx">manifest</span> <span class="p">});</span>

    <span class="c1">// let's extract the bundle ids. This is a bit of js black magic</span>
    <span class="kd">const</span> <span class="nx">bundleIds</span> <span class="o">=</span>  <span class="nx">manifest</span><span class="p">.</span><span class="nx">bundles</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">bundle</span> <span class="o">=&gt;</span> <span class="nx">bundle</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>

    <span class="c1">// we download ALL our bundles and wait for them</span>
    <span class="k">await</span> <span class="nx">Assets</span><span class="p">.</span><span class="nx">loadBundle</span><span class="p">(</span><span class="nx">bundleIds</span><span class="p">);</span>

    <span class="c1">// Code ends when all bundles are loaded!</span>
<span class="p">}</span>

<span class="c1">// Remember to call it and remember it returns a promise</span>
<span class="nx">initializeLoader</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// ALL your assets are ready!</span>
<span class="p">});</span>
</code></pre></div>
<blockquote>
<p>This is enough to start downloading assets... but what about progress? and how can we tell when we are done?</p>
</blockquote>

<p><code>Assets</code> is the global static instance in charge of resolving, downloading and keeping track of all our assets so we never download twice. We initialize with <code>Assets.init(...)</code> feeding it our manifest and then we call <code>Assets.loadBundle(...)</code> with <em>all</em> the names of our <em>asset bundles</em>.  </p>
<h2 id='making-it-look-pretty'>Making it look pretty</h2>
<blockquote>
<p>This is our full code for <code>LoaderScene.ts</code></p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Container</span><span class="p">,</span> <span class="nx">Graphics</span><span class="p">,</span> <span class="nx">Assets</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">pixi.js</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">manifest</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../assets</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">LoaderScene</span> <span class="kd">extends</span> <span class="nx">Container</span> <span class="p">{</span>

    <span class="c1">// for making our loader graphics...</span>
    <span class="k">private</span> <span class="nx">loaderBar</span><span class="p">:</span> <span class="nx">Container</span><span class="p">;</span>
    <span class="k">private</span> <span class="nx">loaderBarBoder</span><span class="p">:</span> <span class="nx">Graphics</span><span class="p">;</span>
    <span class="k">private</span> <span class="nx">loaderBarFill</span><span class="p">:</span> <span class="nx">Graphics</span><span class="p">;</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">screenWidth</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span> <span class="nx">screenHeight</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">();</span>

        <span class="c1">// lets make a loader graphic:</span>
        <span class="kd">const</span> <span class="nx">loaderBarWidth</span> <span class="o">=</span> <span class="nx">screenWidth</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">;</span> <span class="c1">// just an auxiliar variable</span>
        <span class="c1">// the fill of the bar.</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarFill</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Graphics</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarFill</span><span class="p">.</span><span class="nx">beginFill</span><span class="p">(</span><span class="mh">0x008800</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarFill</span><span class="p">.</span><span class="nx">drawRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">loaderBarWidth</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarFill</span><span class="p">.</span><span class="nx">endFill</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarFill</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// we draw the filled bar and with scale we set the %</span>

        <span class="c1">// The border of the bar.</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarBoder</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Graphics</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarBoder</span><span class="p">.</span><span class="nx">lineStyle</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarBoder</span><span class="p">.</span><span class="nx">drawRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">loaderBarWidth</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>

        <span class="c1">// Now we keep the border and the fill in a container so we can move them together.</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Container</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">loaderBarFill</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">loaderBarBoder</span><span class="p">);</span>
        <span class="c1">//Looks complex but this just centers the bar on screen.</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="p">(</span><span class="nx">screenWidth</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span> 
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="p">(</span><span class="nx">screenHeight</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span><span class="p">);</span>

        <span class="c1">// Start loading!</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">initializeLoader</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="c1">// Remember that constructors can't be async, so we are forced to use .then(...) here!</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">gameLoaded</span><span class="p">();</span>
        <span class="p">})</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">async</span> <span class="nx">initializeLoader</span><span class="p">():</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span>
    <span class="p">{</span>
        <span class="k">await</span> <span class="nx">Assets</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span> <span class="na">manifest</span><span class="p">:</span> <span class="nx">manifest</span> <span class="p">});</span>

        <span class="kd">const</span> <span class="nx">bundleIds</span> <span class="o">=</span>  <span class="nx">manifest</span><span class="p">.</span><span class="nx">bundles</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">bundle</span> <span class="o">=&gt;</span> <span class="nx">bundle</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>

        <span class="c1">// The second parameter for `loadBundle` is a function that reports the download progress!</span>
        <span class="k">await</span> <span class="nx">Assets</span><span class="p">.</span><span class="nx">loadBundle</span><span class="p">(</span><span class="nx">bundleIds</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">downloadProgress</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="nx">downloadProgress</span><span class="p">(</span><span class="nx">progressRatio</span><span class="p">:</span> <span class="kr">number</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
        <span class="c1">// progressRatio goes from 0 to 1, so set it to scale</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarFill</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">progressRatio</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="nx">gameLoaded</span><span class="p">():</span> <span class="k">void</span> <span class="p">{</span>
        <span class="c1">// Our game finished loading!</span>

        <span class="c1">// Let's remove our loading bar</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span><span class="p">);</span>

        <span class="c1">// all your assets are ready! I would probably change to another scene</span>
        <span class="c1">// ...but you could build your entire game here if you want</span>
        <span class="c1">// (pls don't)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<blockquote>
<p>Keep in mind that if you have few assets (or a really fast internet connection), you might not see the progress bar at all!</p>
</blockquote>

<p>I will not explain how the loading bar was made. If you need to refresh how to put stuff on screen check <a href="#putting-stuff-on-screen">that chapter again</a>.</p>

<p>You will see that the constructor calls an <code>async</code> function and is forced to use the <code>.then(...)</code> method, that is because constructors can never be <code>async</code>. 
You might have realized that we just downloaded <em>all</em> our assets at the same time, at the very beginning of our game. This is has the benefit that once we leave that loading screen we will never need to download anything else ever again, however we forced our user to stay some time waiting and users nowadays don&#39;t like waiting.<br>
To remedy this we can take a different approach: we just load the bare minimum needed for the current screen and let the rest download in the background. We will see this in a <a href="#recipe-lazy-loading-assets">future recipe</a></p>

<aside class="warning">You might have noted that I used only <code>Graphics</code> to make my loader progress bar. This is because if I were to use assets I would need a loader for the loader assets and that would mess with the space-time continuum. However, should you want your loader to have assets you can reference them directly by URL (<code>Sprite.from(urlHere)</code>) but make sure you call <code>Asssets.init(...)</code> before that, otherwise <code>Assets</code> will auto-initialize itself and your loader will break with a cryptic warning.</aside>
<h2 id='how-to-easily-use-your-loaded-sprites-and-sounds'>How to easily use your loaded Sprites and Sounds?</h2>
<p>Now that we downloaded and safely stored our assets in a cache... how do we use them?<br>
The two basic components we have seen so far are <code>Sprite</code> and <code>Sound</code> and we will use them in different ways.  </p>

<p>For <em>Sprites</em>, all our textures are stored in a <a href="https://pixijs.download/dev/docs/PIXI.utils.html#TextureCache">TextureCache somewhere in the PixiJS universe</a> but all we need to know is that we can access that cache by doing <code>Sprite.from(...)</code> but instead of giving an URL we just give the name we gave our asset in the manifest file. In my example above I could do <code>Sprite.from(&quot;Clampy the clamp&quot;)</code>.  (If you ever need a <code>Texture</code> object, you can get it the same way with <code>Texture.from(...)</code> just remember that <em>Sprites</em> go on screen and <em>Textures</em> hide inside sprites.)</p>

<p>For <em>Sounds</em>, all our sounds are stored in what PixiJS Sound calls <em>sound library</em>. To access it we have to import it as <code>import { sound } from &quot;@pixi/sound&quot;;</code>. That is <code>sound</code> with a <strong>lowercase s</strong>. From there you can play it by doing <code>sound.play(&quot;name we gave in the manifest&quot;);</code>.</p>

<aside class="warning">
PixiJS Sound names can be confusing, while <code>Sound</code> with uppercase is the class for a single sound file, <code>sound</code> with lowercase is the sound library object.
</aside>

<aside class="info">
Remember you can always access your assets with <code>Assets.get("the name you gave your asset in the manifest");</code> and that will return the correct object (for example <code>Texture</code> or a <code>Sound</code>) as long as it was already loaded before. If you are not sure if the asset was loaded before, you should use <code>Assets.load(...);</code>
</aside>
<h2 id='advanced-loading'>Advanced loading</h2>
<p>Ok, we have seen how to load our basic <em>png</em> and <em>mp3</em> but what about other kinds of assets? What about <em>spritesheets</em>, <em>fonts</em>, <em>levels</em>, and more?<br>
This section will show some of the most common asset types and how to load and use them.</p>

<p>But before we start, a bit of how things will work behind the curtains: <em>Assets</em>, <em>Resolvers</em>, <em>Loader</em>, <em>Cache</em> and <em>Detection</em>. 
You might never need to know more about these, but I have to mention them.  </p>

<ul>
<li><a href="https://pixijs.download/dev/docs/PIXI.Assets.html">Assets</a> is a static instance for <code>AssetsClass</code>. It&#39;s the entry point and coordinator of the rest of the system.</li>
<li><a href="https://pixijs.download/dev/docs/PIXI.Resolver.html">Resolver</a> is a class that knows how to map assets to URLs. It also knows how to pick the best asset type for your system.</li>
<li><a href="https://pixijs.download/dev/docs/PIXI.AssetLoader.html">Loader</a> is the bit that actually downloads your file. It does noting else than going to an URL and getting data from it.</li>
<li><a href="https://pixijs.download/dev/docs/PIXI.Cache.html">Cache</a> stores all the related assets for a certain key.</li>
<li><a href="https://pixijs.download/dev/docs/PIXI.FormatDetectionParser.html">Detection</a> is how you tell the rest of the system that you can totally handle that format of asset.</li>
</ul>
<h3 id='spritesheets'>Spritesheets</h3>
<blockquote>
<p>Add this to one of your bundles in <code>assets.ts</code></p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="p">...</span>
    <span class="nx">name</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">bundleName</span><span class="dl">"</span><span class="p">,</span>
    <span class="nx">assets</span><span class="p">:</span>
    <span class="p">{</span>
        <span class="p">...</span>
        <span class="dl">"</span><span class="s2">you probably wont use this name</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">./yourSpritesheetUrl.json</span><span class="dl">"</span><span class="p">,</span>
        <span class="c1">// Don't add an entry for the .png file! Just make sure it exists next to your json file and it will work.</span>
        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">...</span>
</code></pre></div>
<blockquote>
<p>Then your textures from inside your spritesheet will exist in the cache! Ready to Sprite.from()</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="nx">Sprite</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">"</span><span class="s2">Name from inside your spritesheet</span><span class="dl">"</span><span class="p">);</span>
<span class="c1">// or</span>
<span class="nx">Texture</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">"</span><span class="s2">Name from inside your spritesheet</span><span class="dl">"</span><span class="p">);</span>
</code></pre></div>
<p>A spritesheet (also known as texture atlas) is a single image file with many assets inside next to a text file (in our case a <code>json</code> file) that explains how to slice that texture to extract all the assets. It is really good for performance and you should try to always use them.<br>
To create a spritesheet you can use paid programs like <a href="https://www.codeandweb.com/texturepacker">TexturePacker</a> or free ones like <a href="https://renderhjs.net/shoebox/">ShoeBox</a> or <a href="http://free-tex-packer.com/">FreeTexPacker</a>.<br>
If you have problems finding a <em>PixiJS</em> compatible format in the packer of your choice, it might also be called <em>JSON Hash format</em></p>

<p>PixiJS includes a spritesheet parser so all you need to do is provide the <em>url</em> for the <em>json</em> file. <strong>You shouldn&#39;t add the URL for .png file but it must be next to the json file!</strong></p>
<h3 id='fonts'>Fonts</h3>
<blockquote>
<p>Add your fonts to a bundle in your <code>assets.ts</code></p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="p">...</span>
    <span class="nx">name</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">bundleName</span><span class="dl">"</span><span class="p">,</span>
    <span class="nx">assets</span><span class="p">:</span>
    <span class="p">{</span>
        <span class="p">...</span>
        <span class="dl">"</span><span class="s2">you probably wont use this name but don't repeat names</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">./fonts/open-sans.woff2</span><span class="dl">"</span><span class="p">,</span>
        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">...</span>
</code></pre></div>
<blockquote>
<p>Your fonts will be registered into the system and you can just ask for the Font Name. You can check the font name by opening your font file and checking the name. Also, remember you can make your text style with the <a href="https://pixijs.io/pixi-text-style">PixiJS Textstyle editor</a>.</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">customStyleFont</span><span class="p">:</span> <span class="nx">TextStyle</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TextStyle</span><span class="p">({</span>
    <span class="na">fontFamily</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Open Sans Condensed</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// Your official font name</span>
<span class="p">});</span>
<span class="k">new</span> <span class="nx">Text</span><span class="p">(</span><span class="dl">'</span><span class="s1">Ready to use!</span><span class="dl">'</span><span class="p">,</span> <span class="nx">customStyleFont</span><span class="p">);</span> <span class="c1">// Text supports unicode!</span>
</code></pre></div>
<p>In PixiJS v7 fonts are now first class citizens!
To use a custom font your just need to add the font to your manifest, it can be in any format: <code>ttf</code>, <code>otf</code>, <code>woff</code> or <code>woff2</code>.</p>

<aside class="info">
On PixiJS v6 you needed a plugin to load fonts but not anymore. Feel free to remove it if you have it.
</aside>
<h3 id='maps-from-level-editors-or-custom-txt-json-xml-etc'>Maps from level editors or custom txt, json, xml, etc.</h3>
<blockquote>
<p>Just add your custom file to your <code>assets.ts</code></p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code>
<span class="p">...</span>
    <span class="nx">name</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">bundleName</span><span class="dl">"</span><span class="p">,</span>
    <span class="nx">assets</span><span class="p">:</span>
    <span class="p">{</span>
        <span class="p">...</span>
        <span class="dl">"</span><span class="s2">my text</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">./myTextFile.txt</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">my json</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">./myJsonFile.json</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">my xml</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">./myXMLFile.xml</span><span class="dl">"</span><span class="p">,</span>
        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">...</span>
</code></pre></div>
<blockquote>
<p>A good way to see what you got is to <code>console.log()</code></p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="c1">// I can use `Assets.get(...)` because I am 100% sure that the assets are loaded!</span>
<span class="c1">// When in doubt use `Assets.load(...)`!</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">Assets</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">my text</span><span class="dl">"</span><span class="p">));</span> 
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">Assets</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">my json</span><span class="dl">"</span><span class="p">));</span> 
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">Assets</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">my xml</span><span class="dl">"</span><span class="p">));</span> 
</code></pre></div>
<p>The <em>Assets</em> class will recognize simple text formats like <code>txt</code>, <code>json</code> or <code>xml</code> and will give out a somewhat usable object.</p>

<aside class="info">
If a json file happens to be a spritesheet, the Loader will recognize it automatically and process it accordingly. No extra steps are needed!
</aside>

<p>If you would like to parse a particular kind of file you will need to write your own <em>Assets plugin</em>. The best way is to look at the <a href="https://github.com/pixijs/pixijs/blob/dev/packages/spritesheet/src/spritesheetAsset.ts">Spritesheet</a> or <a href="https://github.com/pixijs/pixijs/blob/dev/packages/text-bitmap/src/loadBitmapFont.ts">BitmapFont</a> one and work from there.</p>
<h1 id='recipe-scene-manager'>Recipe: Scene Manager</h1>
<p>In the <a href="#splitting-code">Splitting Code</a> chapter I explained how to create a <code>Scene</code> object to try to encapsulate different parts of our object and be able to swap them when needed but I didn&#39;t explain how to actually change from one scene to the next.<br>
For this purpose, we are going to create a <em>Manager</em> static global class that wraps the PixiJS <code>Application</code> object and exposes a simple way to change from one scene to the next.</p>

<aside class="info">If you are a hardcore programmer from another language you might be familiar with the Singleton pattern and might prefer to use that instead of a static class. Feel free to do so if you feel that is better.</aside>
<h2 id='the-manager-class'>The Manager Class</h2>
<blockquote>
<p>Ok, let&#39;s write our <code>Manager.ts</code> file. This file will store the static class <em>Manager</em> and an Interface for our <em>Scenes</em></p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Application</span><span class="p">,</span> <span class="nx">DisplayObject</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">pixi.js</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">Manager</span> <span class="p">{</span>
    <span class="k">private</span> <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span> <span class="cm">/*this class is purely static. No constructor to see here*/</span> <span class="p">}</span>

    <span class="c1">// Safely store variables for our game</span>
    <span class="k">private</span> <span class="k">static</span> <span class="nx">app</span><span class="p">:</span> <span class="nx">Application</span><span class="p">;</span>
    <span class="k">private</span> <span class="k">static</span> <span class="nx">currentScene</span><span class="p">:</span> <span class="nx">IScene</span><span class="p">;</span>

    <span class="c1">// Width and Height are read-only after creation (for now)</span>
    <span class="k">private</span> <span class="k">static</span> <span class="nx">_width</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="k">private</span> <span class="k">static</span> <span class="nx">_height</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>


    <span class="c1">// With getters but not setters, these variables become read-only</span>
    <span class="k">public</span> <span class="k">static</span> <span class="kd">get</span> <span class="nx">width</span><span class="p">():</span> <span class="kr">number</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Manager</span><span class="p">.</span><span class="nx">_width</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">static</span> <span class="kd">get</span> <span class="nx">height</span><span class="p">():</span> <span class="kr">number</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Manager</span><span class="p">.</span><span class="nx">_height</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Use this function ONCE to start the entire machinery</span>
    <span class="k">public</span> <span class="k">static</span> <span class="nx">initialize</span><span class="p">(</span><span class="nx">width</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span> <span class="nx">height</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span> <span class="nx">background</span><span class="p">:</span> <span class="kr">number</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>

        <span class="c1">// store our width and height</span>
        <span class="nx">Manager</span><span class="p">.</span><span class="nx">_width</span> <span class="o">=</span> <span class="nx">width</span><span class="p">;</span>
        <span class="nx">Manager</span><span class="p">.</span><span class="nx">_height</span> <span class="o">=</span> <span class="nx">height</span><span class="p">;</span>

        <span class="c1">// Create our pixi app</span>
        <span class="nx">Manager</span><span class="p">.</span><span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Application</span><span class="p">({</span>
            <span class="na">view</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">pixi-canvas</span><span class="dl">"</span><span class="p">)</span> <span class="k">as</span> <span class="nx">HTMLCanvasElement</span><span class="p">,</span>
            <span class="na">resolution</span><span class="p">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">devicePixelRatio</span> <span class="o">||</span> <span class="mi">1</span><span class="p">,</span>
            <span class="na">autoDensity</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="na">backgroundColor</span><span class="p">:</span> <span class="nx">background</span><span class="p">,</span>
            <span class="na">width</span><span class="p">:</span> <span class="nx">width</span><span class="p">,</span>
            <span class="na">height</span><span class="p">:</span> <span class="nx">height</span>
        <span class="p">});</span>

        <span class="c1">// Add the ticker</span>
        <span class="nx">Manager</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">ticker</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">Manager</span><span class="p">.</span><span class="nx">update</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// Call this function when you want to go to a new scene</span>
    <span class="k">public</span> <span class="k">static</span> <span class="nx">changeScene</span><span class="p">(</span><span class="nx">newScene</span><span class="p">:</span> <span class="nx">IScene</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
        <span class="c1">// Remove and destroy old scene... if we had one..</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Manager</span><span class="p">.</span><span class="nx">currentScene</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">Manager</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">stage</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">Manager</span><span class="p">.</span><span class="nx">currentScene</span><span class="p">);</span>
            <span class="nx">Manager</span><span class="p">.</span><span class="nx">currentScene</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="c1">// Add the new one</span>
        <span class="nx">Manager</span><span class="p">.</span><span class="nx">currentScene</span> <span class="o">=</span> <span class="nx">newScene</span><span class="p">;</span>
        <span class="nx">Manager</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">stage</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">Manager</span><span class="p">.</span><span class="nx">currentScene</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// This update will be called by a pixi ticker and tell the scene that a tick happened</span>
    <span class="k">private</span> <span class="k">static</span> <span class="nx">update</span><span class="p">(</span><span class="nx">framesPassed</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
        <span class="c1">// Let the current scene know that we updated it...</span>
        <span class="c1">// Just for funzies, sanity check that it exists first.</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Manager</span><span class="p">.</span><span class="nx">currentScene</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">Manager</span><span class="p">.</span><span class="nx">currentScene</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">framesPassed</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// as I said before, I HATE the "frame passed" approach. I would rather use `Manager.app.ticker.deltaMS`</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// This could have a lot more generic functions that you force all your scenes to have. Update is just an example.</span>
<span class="c1">// Also, this could be in its own file...</span>
<span class="k">export</span> <span class="kr">interface</span> <span class="nx">IScene</span> <span class="kd">extends</span> <span class="nx">DisplayObject</span> <span class="p">{</span>
    <span class="nx">update</span><span class="p">(</span><span class="nx">framesPassed</span><span class="p">:</span> <span class="kr">number</span><span class="p">):</span> <span class="k">void</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>Lots to unpack here but let&#39;s take it easy.<br>
First of all, see that since I made this a fully static class I never use <code>this</code> object but instead I refer to everything by using the <code>Manager.</code> notation. This prevents the need to keep track of the context in this class.  </p>

<p>Next, we have a private constructor; that means nobody will be able to do <code>new Manager()</code>. That is important because our class is fully static and it&#39;s meant to be initialized by calling <code>Manager.initialize(...)</code> and we feed parameters about the screen size and the background color for our game.<br>
The <code>Application</code> instance and the <em>width</em> and <em>height</em> are safely stored and hidden in private static variables but these last two have getters so we can ask globally what is the size of our game.  </p>

<p>The initialize function has one last trick: it adds links from your entire <code>Manager</code> to a ticker so that our <code>Manager.update()</code> method gets called. That update will then call the current scene update method. This will allow you to have an update method in your scenes that appears to be called <em>magically</em>.</p>

<p>Then we have the <code>Manager.changeScene(...)</code> method, this is exactly why we started all of this, an easy way to tell our game that the current scene is no longer useful and that we want to change it for a new one.<br>
It&#39;s quite simple to see that <code>Manager</code> removes the old one from the screen, destroys it (actually, <code>destroy()</code> is a PixiJS method!), and then proceeds to put your new scene directly on screen.  </p>

<p>But...<br>
<em>What is a Scene? A miserable little pile of pixels!</em><br>
Well, it has to be a <code>DisplayObject</code> of some sort because we need to put it on the screen (remember that <code>Containers</code> <em>are DisplayObjects</em>) but we also want it to have our custom <code>update(...)</code> method and to enforce that we create an interface <code>IScene</code> (I like to begin my interfaces with <code>I</code>). This makes sure that if an object wants to be a <em>Scene</em> then it must follow the two rules: be some sort of <code>DisplayObject</code> and have an <code>update(...)</code> method.</p>
<h2 id='now-some-reruns-of-your-favorite-classes'>Now, some reruns of your favorite classes!</h2>
<blockquote>
<p>Look at this buffed up <code>LoaderScene.ts</code> that now <code>implements IScene</code> and uses <code>Manager</code> to know its size!</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Container</span><span class="p">,</span> <span class="nx">Graphics</span><span class="p">,</span> <span class="nx">Assets</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">pixi.js</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">assets</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../assets</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">IScene</span><span class="p">,</span> <span class="nx">Manager</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../Manager</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">GameScene</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./GameScene</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">LoaderScene</span> <span class="kd">extends</span> <span class="nx">Container</span> <span class="k">implements</span> <span class="nx">IScene</span> <span class="p">{</span>

    <span class="c1">// for making our loader graphics...</span>
    <span class="k">private</span> <span class="nx">loaderBar</span><span class="p">:</span> <span class="nx">Container</span><span class="p">;</span>
    <span class="k">private</span> <span class="nx">loaderBarBoder</span><span class="p">:</span> <span class="nx">Graphics</span><span class="p">;</span>
    <span class="k">private</span> <span class="nx">loaderBarFill</span><span class="p">:</span> <span class="nx">Graphics</span><span class="p">;</span>
    <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">();</span>

        <span class="kd">const</span> <span class="nx">loaderBarWidth</span> <span class="o">=</span> <span class="nx">Manager</span><span class="p">.</span><span class="nx">width</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarFill</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Graphics</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarFill</span><span class="p">.</span><span class="nx">beginFill</span><span class="p">(</span><span class="mh">0x008800</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarFill</span><span class="p">.</span><span class="nx">drawRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">loaderBarWidth</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarFill</span><span class="p">.</span><span class="nx">endFill</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarFill</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarBoder</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Graphics</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarBoder</span><span class="p">.</span><span class="nx">lineStyle</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarBoder</span><span class="p">.</span><span class="nx">drawRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">loaderBarWidth</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Container</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">loaderBarFill</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">loaderBarBoder</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="p">(</span><span class="nx">Manager</span><span class="p">.</span><span class="nx">width</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="p">(</span><span class="nx">Manager</span><span class="p">.</span><span class="nx">height</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">initializeLoader</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">gameLoaded</span><span class="p">();</span>
        <span class="p">})</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">async</span> <span class="nx">initializeLoader</span><span class="p">():</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span>
    <span class="p">{</span>
        <span class="k">await</span> <span class="nx">Assets</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span> <span class="na">manifest</span><span class="p">:</span> <span class="nx">manifest</span> <span class="p">});</span>

        <span class="kd">const</span> <span class="nx">bundleIds</span> <span class="o">=</span>  <span class="nx">manifest</span><span class="p">.</span><span class="nx">bundles</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">bundle</span> <span class="o">=&gt;</span> <span class="nx">bundle</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>

        <span class="k">await</span> <span class="nx">Assets</span><span class="p">.</span><span class="nx">loadBundle</span><span class="p">(</span><span class="nx">bundleIds</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">downloadProgress</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="nx">downloadProgress</span><span class="p">(</span><span class="nx">progressRatio</span><span class="p">:</span> <span class="kr">number</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarFill</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">progressRatio</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="nx">gameLoaded</span><span class="p">():</span> <span class="k">void</span> <span class="p">{</span>
        <span class="c1">// Change scene to the game scene!</span>
        <span class="nx">Manager</span><span class="p">.</span><span class="nx">changeScene</span><span class="p">(</span><span class="k">new</span> <span class="nx">GameScene</span><span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="nx">update</span><span class="p">(</span><span class="nx">framesPassed</span><span class="p">:</span> <span class="kr">number</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
        <span class="c1">// To be a scene we must have the update method even if we don't use it.</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>In this new <code>LoaderScene</code> that extends from <code>IScene</code> there are really only two changes:<br>
* It now extends from <code>IScene</code> so it must have an <code>update(...)</code> method even if we don&#39;t need it.
* When the loader finishes, it changes the scene to another one! We can finally see <code>Manager.changeScene()</code> in action!</p>

<blockquote>
<p>And this is what the simpler <code>GameScene.ts</code> looks like.</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Container</span><span class="p">,</span> <span class="nx">Sprite</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">pixi.js</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">IScene</span><span class="p">,</span> <span class="nx">Manager</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../Manager</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">GameScene</span> <span class="kd">extends</span> <span class="nx">Container</span> <span class="k">implements</span> <span class="nx">IScene</span> <span class="p">{</span>
    <span class="k">private</span> <span class="nx">clampy</span><span class="p">:</span> <span class="nx">Sprite</span><span class="p">;</span>
    <span class="k">private</span> <span class="nx">clampyVelocity</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">();</span>

        <span class="c1">// Inside assets.ts we have a line that says `"Clampy from assets.ts!": "./clampy.png",`</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span> <span class="o">=</span> <span class="nx">Sprite</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">"</span><span class="s2">Clampy from assets.ts!</span><span class="dl">"</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">anchor</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="mf">0.5</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">Manager</span><span class="p">.</span><span class="nx">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">Manager</span><span class="p">.</span><span class="nx">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">clampyVelocity</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="nx">update</span><span class="p">(</span><span class="nx">framesPassed</span><span class="p">:</span> <span class="kr">number</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
        <span class="c1">// Lets move clampy!</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">clampyVelocity</span> <span class="o">*</span> <span class="nx">framesPassed</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">x</span> <span class="o">&gt;</span> <span class="nx">Manager</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">Manager</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">clampyVelocity</span> <span class="o">=</span> <span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">clampyVelocity</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">clampy</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">clampyVelocity</span> <span class="o">=</span> <span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">clampyVelocity</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h2 id='turning-on-the-entire-machine'>Turning on the entire machine</h2>
<blockquote>
<p><code>index.ts</code> has always been the entry point of our game. Let&#39;s use it to start our <code>Manager</code> and open our first ever <code>Scene</code></p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Manager</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./Manager</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">LoaderScene</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./scenes/LoaderScene</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">Manager</span><span class="p">.</span><span class="nx">initialize</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="mh">0x6495ed</span><span class="p">);</span>

<span class="c1">// We no longer need to tell the scene the size because we can ask Manager!</span>
<span class="kd">const</span> <span class="nx">loady</span><span class="p">:</span> <span class="nx">LoaderScene</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">LoaderScene</span><span class="p">();</span>
<span class="nx">Manager</span><span class="p">.</span><span class="nx">changeScene</span><span class="p">(</span><span class="nx">loady</span><span class="p">);</span>
</code></pre></div>
<p>So far we have a <em>Manager</em> that can change from one <em>Scene</em> to the next but... how do we start it and go to the first scene ever?<br>
That is what the <code>Manager.initialize(...)</code> was for and we will call it directly from <code>index.ts</code> and right after that, we ask it to go to the first scene of our game: the <code>LoaderScene</code>.  </p>

<p>That is all there is to it. You <em>initialize</em> your <em>manager</em> and are ready to rumble from <em>scene</em> to <em>scene</em>!</p>
<h1 id='recipe-resize-your-game'>Recipe: Resize your game</h1>
<p>By now you probably have realized that all the examples so far have the game in the top-left corner of the screen, this is because we never bothered to move it or change its size: Let&#39;s make it fill the screen.<br>
There are two ways to fill the screen that I like to call <em>letterbox</em> and <em>responsive</em>.<br>
In <em>letterbox</em> you scale your entire game and add black bars to the side when the aspect ratio doesn&#39;t match, this is the easier approach and is good enough for small games that will be embedded in an iframe of another website. By using this method the resize is done entirely by the browser with some <em>css</em> trickery so you don&#39;t have to add any logic inside your game.
In <em>responsive</em> you make your <code>stage</code> grow to fill the entire screen and you have to resize and rearrange your game elements to make your game take advantage of all the screen space available, this is almost is mandatory if you are trying to make a game that looks and feel <em>native</em> on every device (mostly smartphones). However, this approach is <em>harder</em> to implement as you have to always be mindful of the scale of your objects, sizes, and positions of the elements of your game.</p>

<blockquote>
<p>To ask the browser what is the current screen size we will use a small catch-all piece of code. This is to make sure we get the correct measurement no matter what web browser the user has.</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">screenWidth</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">clientWidth</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">screenHeight</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">clientHeight</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
</code></pre></div>
<p>In any case, we will know the initial screen size (and if the screen changed the size) by using what the browser provides us.</p>
<h2 id='letterbox-scale'>Letterbox scale</h2>
<blockquote>
<p>Here you have a modified <code>Manager.ts</code> class that listens for a resize event and uses css to fix the size of the game.</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">Manager</span> <span class="p">{</span>
    <span class="k">private</span> <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>

    <span class="k">private</span> <span class="k">static</span> <span class="nx">app</span><span class="p">:</span> <span class="nx">Application</span><span class="p">;</span>
    <span class="k">private</span> <span class="k">static</span> <span class="nx">currentScene</span><span class="p">:</span> <span class="nx">IScene</span><span class="p">;</span>

    <span class="k">private</span> <span class="k">static</span> <span class="nx">_width</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
    <span class="k">private</span> <span class="k">static</span> <span class="nx">_height</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>


    <span class="k">public</span> <span class="k">static</span> <span class="kd">get</span> <span class="nx">width</span><span class="p">():</span> <span class="kr">number</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Manager</span><span class="p">.</span><span class="nx">_width</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">static</span> <span class="kd">get</span> <span class="nx">height</span><span class="p">():</span> <span class="kr">number</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Manager</span><span class="p">.</span><span class="nx">_height</span><span class="p">;</span>
    <span class="p">}</span>


    <span class="k">public</span> <span class="k">static</span> <span class="nx">initialize</span><span class="p">(</span><span class="nx">width</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span> <span class="nx">height</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span> <span class="nx">background</span><span class="p">:</span> <span class="kr">number</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>

        <span class="nx">Manager</span><span class="p">.</span><span class="nx">_width</span> <span class="o">=</span> <span class="nx">width</span><span class="p">;</span>
        <span class="nx">Manager</span><span class="p">.</span><span class="nx">_height</span> <span class="o">=</span> <span class="nx">height</span><span class="p">;</span>

        <span class="nx">Manager</span><span class="p">.</span><span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Application</span><span class="p">({</span>
            <span class="na">view</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">pixi-canvas</span><span class="dl">"</span><span class="p">)</span> <span class="k">as</span> <span class="nx">HTMLCanvasElement</span><span class="p">,</span>
            <span class="na">resolution</span><span class="p">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">devicePixelRatio</span> <span class="o">||</span> <span class="mi">1</span><span class="p">,</span>
            <span class="na">autoDensity</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="na">backgroundColor</span><span class="p">:</span> <span class="nx">background</span><span class="p">,</span>
            <span class="na">width</span><span class="p">:</span> <span class="nx">width</span><span class="p">,</span>
            <span class="na">height</span><span class="p">:</span> <span class="nx">height</span>
        <span class="p">});</span>

        <span class="nx">Manager</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">ticker</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">Manager</span><span class="p">.</span><span class="nx">update</span><span class="p">)</span>

        <span class="c1">// listen for the browser telling us that the screen size changed</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">resize</span><span class="dl">"</span><span class="p">,</span> <span class="nx">Manager</span><span class="p">.</span><span class="nx">resize</span><span class="p">);</span>

        <span class="c1">// call it manually once so we are sure we are the correct size after starting</span>
        <span class="nx">Manager</span><span class="p">.</span><span class="nx">resize</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="nx">resize</span><span class="p">():</span> <span class="k">void</span> <span class="p">{</span>
        <span class="c1">// current screen size</span>
        <span class="kd">const</span> <span class="nx">screenWidth</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">clientWidth</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
        <span class="kd">const</span> <span class="nx">screenHeight</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">clientHeight</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>

        <span class="c1">// uniform scale for our game</span>
        <span class="kd">const</span> <span class="nx">scale</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">screenWidth</span> <span class="o">/</span> <span class="nx">Manager</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">screenHeight</span> <span class="o">/</span> <span class="nx">Manager</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>

        <span class="c1">// the "uniformly englarged" size for our game</span>
        <span class="kd">const</span> <span class="nx">enlargedWidth</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">scale</span> <span class="o">*</span> <span class="nx">Manager</span><span class="p">.</span><span class="nx">width</span><span class="p">);</span>
        <span class="kd">const</span> <span class="nx">enlargedHeight</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">scale</span> <span class="o">*</span> <span class="nx">Manager</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>

        <span class="c1">// margins for centering our game</span>
        <span class="kd">const</span> <span class="nx">horizontalMargin</span> <span class="o">=</span> <span class="p">(</span><span class="nx">screenWidth</span> <span class="o">-</span> <span class="nx">enlargedWidth</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
        <span class="kd">const</span> <span class="nx">verticalMargin</span> <span class="o">=</span> <span class="p">(</span><span class="nx">screenHeight</span> <span class="o">-</span> <span class="nx">enlargedHeight</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>

        <span class="c1">// now we use css trickery to set the sizes and margins</span>
        <span class="nx">Manager</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">enlargedWidth</span><span class="p">}</span><span class="s2">px`</span><span class="p">;</span>
        <span class="nx">Manager</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">enlargedHeight</span><span class="p">}</span><span class="s2">px`</span><span class="p">;</span>
        <span class="nx">Manager</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">marginLeft</span> <span class="o">=</span> <span class="nx">Manager</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">marginRight</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">horizontalMargin</span><span class="p">}</span><span class="s2">px`</span><span class="p">;</span>
        <span class="nx">Manager</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">marginTop</span> <span class="o">=</span> <span class="nx">Manager</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">marginBottom</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">verticalMargin</span><span class="p">}</span><span class="s2">px`</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cm">/* More code of your Manager.ts like `changeScene` and `update`*/</span>
<span class="p">}</span>
</code></pre></div>
<blockquote>
<p>If you are not using a <em>Manager</em> you need to focus on the <code>window.addEventListener(...)</code> and the <code>resize()</code> method.</p>
</blockquote>

<p>Letterbox scale implies two things: Making our game <em>as big as possible</em> (while still fitting on screen) and then <em>centering it on the screen</em> (letting black bars appear on the edges where the ratio doesn&#39;t match).<br>
It is very important that when we make it <em>as big as possible</em> we don&#39;t stretch it and make it look funky, to make sure of this we find the <em>enlargement factor</em> and increase our width and height by multiplying this <em>factor</em>.<br>
To get a factor you just <em>divide the size of the screen by the size of your game</em> but since you have <em>width</em> and <em>height</em> you end up with two factors. To make sure our game doesn&#39;t <em>bleed out</em> of the screen and <em>fits inside</em> we pick the smaller of the two factors we found and we multiply our <em>width</em> and <em>height</em> by it.</p>

<p>After we have our <em>englarged</em> size by multiplying by a factor, we calculate the difference between that size and the size of the screen and split it evenly in the margins so our game ends up centered.</p>

<aside class="info">
You might see that I read but never change the <code>Manager.width</code> and <code>Manager.height</code> variables. That is because our game never realizes it is now being enlarged: everything happens at the browser level with css so our game still believes to have the size that <code>Manager.width</code> and <code>Manager.height</code> says.
</aside>
<h2 id='responsive-scale'>Responsive Scale</h2>
<blockquote>
<p>Here you have a modified <code>Manager.ts</code> class that listens for a resize event and notifies the current scene of the new size.</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">Manager</span> <span class="p">{</span>
    <span class="k">private</span> <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
    <span class="k">private</span> <span class="k">static</span> <span class="nx">app</span><span class="p">:</span> <span class="nx">Application</span><span class="p">;</span>
    <span class="k">private</span> <span class="k">static</span> <span class="nx">currentScene</span><span class="p">:</span> <span class="nx">IScene</span><span class="p">;</span>

    <span class="c1">// We no longer need to store width and height since now it is literally the size of the screen.</span>
    <span class="c1">// We just modify our getters</span>
    <span class="k">public</span> <span class="k">static</span> <span class="kd">get</span> <span class="nx">width</span><span class="p">():</span> <span class="kr">number</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">clientWidth</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">static</span> <span class="kd">get</span> <span class="nx">height</span><span class="p">():</span> <span class="kr">number</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">clientHeight</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="nx">initialize</span><span class="p">(</span><span class="nx">background</span><span class="p">:</span> <span class="kr">number</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>

        <span class="nx">Manager</span><span class="p">.</span><span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Application</span><span class="p">({</span>
            <span class="na">view</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">pixi-canvas</span><span class="dl">"</span><span class="p">)</span> <span class="k">as</span> <span class="nx">HTMLCanvasElement</span><span class="p">,</span>
            <span class="na">resizeTo</span><span class="p">:</span> <span class="nb">window</span><span class="p">,</span> <span class="c1">// This line here handles the actual resize!</span>
            <span class="na">resolution</span><span class="p">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">devicePixelRatio</span> <span class="o">||</span> <span class="mi">1</span><span class="p">,</span>
            <span class="na">autoDensity</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="na">backgroundColor</span><span class="p">:</span> <span class="nx">background</span><span class="p">,</span>
        <span class="p">});</span>

        <span class="nx">Manager</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">ticker</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">Manager</span><span class="p">.</span><span class="nx">update</span><span class="p">)</span>

        <span class="c1">// listen for the browser telling us that the screen size changed</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">resize</span><span class="dl">"</span><span class="p">,</span> <span class="nx">Manager</span><span class="p">.</span><span class="nx">resize</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="nx">resize</span><span class="p">():</span> <span class="k">void</span> <span class="p">{</span>
        <span class="c1">// if we have a scene, we let it know that a resize happened!</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Manager</span><span class="p">.</span><span class="nx">currentScene</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">Manager</span><span class="p">.</span><span class="nx">currentScene</span><span class="p">.</span><span class="nx">resize</span><span class="p">(</span><span class="nx">Manager</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">Manager</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="cm">/* More code of your Manager.ts like `changeScene` and `update`*/</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kr">interface</span> <span class="nx">IScene</span> <span class="kd">extends</span> <span class="nx">DisplayObject</span> <span class="p">{</span>
    <span class="nx">update</span><span class="p">(</span><span class="nx">framesPassed</span><span class="p">:</span> <span class="kr">number</span><span class="p">):</span> <span class="k">void</span><span class="p">;</span>

    <span class="c1">// we added the resize method to the interface</span>
    <span class="nx">resize</span><span class="p">(</span><span class="nx">screenWidth</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span> <span class="nx">screenHeight</span><span class="p">:</span> <span class="kr">number</span><span class="p">):</span> <span class="k">void</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<blockquote>
<p>If you are not using a <em>Manager</em> you need to focus on the <code>resizeTo: window,</code> line in the constructor of <code>Application</code>.</p>
</blockquote>

<p>To turn on Responsive resize is actually just one line of code: you add <code>resizeTo: window,</code> to your PixiJS <code>Application</code> object and it will work however your game won&#39;t realize that now has to move and fill the new space (or fit inside a smaller space).<br>
To make this task a bit less hard, we need to know <em>when</em> the game changed size and what is that new size.<br>
To do this, we will listen for the <code>resize</code> event, update our <code>Manager.width</code> and <code>Manager.height</code> variables, and let the current scene know that a change in size occurred. To <em>let the scene know</em> we are going to add a function to our <code>IScene</code> interface so all scenes must now have the <code>resize(...)</code> method.  </p>

<p>After that... you are on your own: You need to write your own code inside each scene <code>resize(...)</code> method to make sure every single object in your game reacts accordingly to your new screen size. Good luck.</p>

<aside class="info">
You might realize that we no longer have `width` and `height` variables but instead, we calculate them directly from the screen. You might want to store an <i>ideal size</i> for making scale calculations.
</aside>
<h2 id='resolution-device-pixel-ratio'>Resolution (Device Pixel Ratio)</h2><div class="highlight"><pre class="highlight typescript"><code><span class="k">new</span> <span class="nx">Application</span><span class="p">({</span>
    <span class="na">view</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">pixi-canvas</span><span class="dl">"</span><span class="p">)</span> <span class="k">as</span> <span class="nx">HTMLCanvasElement</span><span class="p">,</span>
    <span class="na">resolution</span><span class="p">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">devicePixelRatio</span> <span class="o">||</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">// This bad boy right here...</span>
    <span class="na">autoDensity</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="c1">// and his friend</span>
    <span class="na">backgroundColor</span><span class="p">:</span> <span class="nx">background</span><span class="p">,</span>
    <span class="na">width</span><span class="p">:</span> <span class="nx">width</span><span class="p">,</span>
    <span class="na">height</span><span class="p">:</span> <span class="nx">height</span>
<span class="p">});</span>
</code></pre></div>
<p>The keen-eyed of you might have noticed that when we create our <code>Application</code> object we have a line that says <code>resolution: window.devicePixelRatio || 1</code> but what does that mean?<br>
The standard for screens was set to 96 dpi (dots per inch) for a long time and we were happy until the Apple nation attacked with their <em>Retina Display</em> that had twice as many dots per inch, thus if <code>devicePixelRatio</code> was equal to 1 it meant <em>96 dpi</em> and if it was equal to 2 it was <em>Retina display</em>.<br>
And then the world kept moving forward, adding more and more dots per inch, in seemingly random amounts so <code>devicePixelRatio</code> started reporting decimal numbers left and right: everything as a factor of that original  <em>96 dpi</em>.  </p>

<p>There is the complementary line that says <code>autoDensity: true</code> and that is meant for the <code>InteractionManager</code>. It makes it so that DOM and CSS coordinates (and thus, touch and mouse coordinates) match your global pixel units.</p>

<p>By letting feeding the <code>Apllication</code> constructor the <code>devicePixelRatio</code> we render our game in a <em>native resolution</em> for the displays dpi, resulting in a sharper image on devices that have more than <em>96 dpi</em> but at the cost of some performance since we are effectively <em>supersampling</em> every pixel.  </p>

<p>If a particular device (most likely an iOS device) isn&#39;t strong enough to render all the pixels of the <em>native resoluton</em> you can always force the resolution to 96 dpi with <code>resolution: 1</code> and get an image that might be blurry but you get a non-despicable performance boost.</p>

<aside class="info">
Let's get the javascript out of the way: <code>window.devicePixelRatio</code> should always be a number however some old browsers might say <code>NaN</code> or <code>undefined</code> and feeding such a value to the <code>Application</code> constructor might produce unexpected results. That <code>||1</code> makes sure we never feed it something that isn't a number.
</aside>

<aside class="info">
Fun fact: Some devices consider the standard to be 76 dpi instead of 96. However don't worry, this doesn't change how we use <code>devicePixelRatio</code>
</aside>
<h1 id='older-guides'>Older guides</h1>
<p>As PixiJS moves forward I will try to keep these guides updated. Sometimes this will mean that I will make small modifications here and there to make sure this guide works for the latest version of PixiJS.<br>
However, some changes will be too big and entire sections will become obsolete and new sections will need to be created.<br>
Below you will find all those sections that got retired.</p>
<h1 id='recipe-preloading-assets-v6'>Recipe: Preloading assets v6</h1>
<p><em>Superseded by the <code>Assets</code> class in PixiJS v7</em></p>

<p>So far we have seen how to create images and sounds by downloading the asset behind them just as we need to show it to the user. While this is good enough if we want a quick way to make a proof of concept or prototype, it won&#39;t be good enough for a project release.<br>
The elegant way of doing it is downloading all the assets you are going to need beforehand and storing them in some sort of cache. To this purpose, PixiJS includes <a href="https://pixijs.download/v6.5.8/docs/PIXI.Loader.html">Loader</a>: An extensible class to allow the download and caching of any file you might need for your game.  </p>

<p>In this recipe, we are going to create one of our <code>Scene</code> to load all the files we declare in a manifest object and then I will teach you how to recover the files from the <code>Loader</code> cache.</p>
<h2 id='the-file-to-download-manifest'>The file to download manifest.</h2>
<blockquote>
<p>Let&#39;s start with our <em>manifest</em> object. I will call this file <code>assets.ts</code></p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="k">export</span> <span class="kd">const</span> <span class="nx">assets</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Clampy the clamp</span><span class="dl">"</span><span class="p">,</span> <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">./clampy.png</span><span class="dl">"</span> <span class="p">},</span>
    <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">another image</span><span class="dl">"</span><span class="p">,</span> <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">./monster.png</span><span class="dl">"</span> <span class="p">},</span>
    <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">whistle</span><span class="dl">"</span><span class="p">,</span> <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">./whistle.mp3</span><span class="dl">"</span> <span class="p">},</span>
<span class="p">]</span>
</code></pre></div>
<p>As javascript is unable to &quot;scan&quot; a directory and just load everything inside we need to add some sort of <em>manifest object</em> that lists all the files that we need to download.
Here we can see we are how we can declare (and export for outside use) an array of objects that will be used by the <code>Loader</code>.<br>
The <code>name</code> field is going to be our <em>key</em> to retrieve the downloaded object and the <code>url</code> field must point to where our asset is going to be located (by starting with <code>./</code> we mean &quot;relative to our <em>index.html</em>&quot;).  </p>
<h2 id='how-to-use-the-loader'>How to use the <em>Loader</em></h2>
<blockquote>
<p>This is just a snippet of how to use <code>Loader</code>. After this, we will see how to make a full loader <code>Scene</code></p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="c1">// remember the assets manifest we created before? You need to import it here</span>
<span class="nx">Loader</span><span class="p">.</span><span class="nx">shared</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">assets</span><span class="p">);</span>

<span class="c1">// this will start the load of the files</span>
<span class="nx">Loader</span><span class="p">.</span><span class="nx">shared</span><span class="p">.</span><span class="nx">load</span><span class="p">();</span>

<span class="c1">// In the future, when the download finishes you will find your entire asset like this</span>
<span class="nx">Loader</span><span class="p">.</span><span class="nx">shared</span><span class="p">.</span><span class="nx">resources</span><span class="p">[</span><span class="dl">"</span><span class="s2">the name you gave your asset in the manifest</span><span class="dl">"</span><span class="p">];</span> 
<span class="c1">// You will probably want `.data` or `.texture` or `.sound` of this object </span>
<span class="c1">// however for Pixi objects there is are better ways of creating them...</span>
</code></pre></div>
<blockquote>
<p>This is enough to start downloading assets... but what about progress? and how can we tell when we are done?</p>
</blockquote>

<p>Like the <code>Ticker</code> class we saw before (and many other PixiJS classes), <code>Loader</code> has a <em>shared</em> instance we can access globally and we are going to use that to load our assets and keep them in <em>cache</em> so we can reference them without downloading them each time.<br>
The <code>add(...)</code> method can take many shapes but we are feeding it our resource manifest we stored in <code>assets.ts</code> and then begin the download by calling the <code>load()</code> method.</p>
<h2 id='making-it-look-pretty'>Making it look pretty</h2>
<blockquote>
<p>This is our full code for <code>LoaderScene.ts</code></p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Container</span><span class="p">,</span> <span class="nx">Graphics</span><span class="p">,</span> <span class="nx">Loader</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">pixi.js</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">assets</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../assets</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">LoaderScene</span> <span class="kd">extends</span> <span class="nx">Container</span> <span class="p">{</span>

    <span class="c1">// for making our loader graphics...</span>
    <span class="k">private</span> <span class="nx">loaderBar</span><span class="p">:</span> <span class="nx">Container</span><span class="p">;</span>
    <span class="k">private</span> <span class="nx">loaderBarBoder</span><span class="p">:</span> <span class="nx">Graphics</span><span class="p">;</span>
    <span class="k">private</span> <span class="nx">loaderBarFill</span><span class="p">:</span> <span class="nx">Graphics</span><span class="p">;</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">screenWidth</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span> <span class="nx">screenHeight</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">();</span>

        <span class="c1">// lets make a loader graphic:</span>
        <span class="kd">const</span> <span class="nx">loaderBarWidth</span> <span class="o">=</span> <span class="nx">screenWidth</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">;</span> <span class="c1">// just an auxiliar variable</span>
        <span class="c1">// the fill of the bar.</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarFill</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Graphics</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarFill</span><span class="p">.</span><span class="nx">beginFill</span><span class="p">(</span><span class="mh">0x008800</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarFill</span><span class="p">.</span><span class="nx">drawRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">loaderBarWidth</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarFill</span><span class="p">.</span><span class="nx">endFill</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarFill</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// we draw the filled bar and with scale we set the %</span>

        <span class="c1">// The border of the bar.</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarBoder</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Graphics</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarBoder</span><span class="p">.</span><span class="nx">lineStyle</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarBoder</span><span class="p">.</span><span class="nx">drawRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">loaderBarWidth</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>

        <span class="c1">// Now we keep the border and the fill in a container so we can move them together.</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Container</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">loaderBarFill</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">loaderBarBoder</span><span class="p">);</span>
        <span class="c1">//Looks complex but this just centers the bar on screen.</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="p">(</span><span class="nx">screenWidth</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span> 
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="p">(</span><span class="nx">screenHeight</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span><span class="p">);</span>

        <span class="c1">// Now the actual asset loader:</span>

        <span class="c1">// we add the asset manifest</span>
        <span class="nx">Loader</span><span class="p">.</span><span class="nx">shared</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">assets</span><span class="p">);</span>

        <span class="c1">// connect the events</span>
        <span class="nx">Loader</span><span class="p">.</span><span class="nx">shared</span><span class="p">.</span><span class="nx">onProgress</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">downloadProgress</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
        <span class="nx">Loader</span><span class="p">.</span><span class="nx">shared</span><span class="p">.</span><span class="nx">onComplete</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">gameLoaded</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>

        <span class="c1">// Start loading!</span>
        <span class="nx">Loader</span><span class="p">.</span><span class="nx">shared</span><span class="p">.</span><span class="nx">load</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="nx">downloadProgress</span><span class="p">(</span><span class="nx">loader</span><span class="p">:</span> <span class="nx">Loader</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
        <span class="c1">// Progress goes from 0 to 100 but we are going to use 0 to 1 to set it to scale</span>
        <span class="kd">const</span> <span class="nx">progressRatio</span> <span class="o">=</span> <span class="nx">loader</span><span class="p">.</span><span class="nx">progress</span> <span class="o">/</span> <span class="mi">100</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loaderBarFill</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">progressRatio</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="nx">gameLoaded</span><span class="p">():</span> <span class="k">void</span> <span class="p">{</span>
        <span class="c1">// Our game finished loading!</span>

        <span class="c1">// Let's remove our loading bar</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">loaderBar</span><span class="p">);</span>

        <span class="c1">// all your assets are ready! I would probably change to another scene</span>
        <span class="c1">// ...but you could build your entire game here if you want</span>
        <span class="c1">// (pls don't)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<blockquote>
<p>Keep in mind that if you have few assets (or a really fast internet connection), you might not see the progress bar at all!</p>
</blockquote>

<p>I will not explain how the loading bar was made. If you need to refresh how to put stuff on screen check <a href="#putting-stuff-on-screen">that chapter again</a>.</p>

<p>Those events don&#39;t look exactly like the other events we saw in the <a href="#getting-interactive">Interaction section</a> and that is because <em>Loader</em> uses their own kind of events called <em>signals</em> or <em>minisignals</em> however they work quite similarly to regular events, the big difference is that each <em>signal</em> is only good for one kind of event and that is why we don&#39;t have a string explaining what kind of event we need and instead we have two objects <code>onProgress</code> and <code>onComplete</code>.</p>

<aside class="info">You might have noted that I used only <code>Graphics</code> to make my loader progress bar. This is because if I were to use assets I would need a loader for the loader assets and that would mess with the space-time continuum. However, should you want your loader to have assets you can reference them directly by URL (<code>Sprite.from(urlHere)</code>) or make your loader... loader and indeed destroy space-time itself.</aside>
<h2 id='how-to-easily-use-your-loaded-sprites-and-sounds'>How to easily use your loaded Sprites and Sounds?</h2>
<p>Now that we downloaded and safely stored our assets in a cache... how do we use them?<br>
The two basic components we have seen so far are <code>Sprite</code> and <code>Sound</code> and we will use them in different ways.  </p>

<p>For <em>Sprites</em>, all our textures are stored in a <a href="https://pixijs.download/dev/docs/PIXI.utils.html#TextureCache">TextureCache somewhere in the PixiJS universe</a> but all we need to know is that we can access that cache by doing <code>Sprite.from(...)</code> but instead of giving an URL we just give the name we gave our asset in the manifest file. In my example above I could do <code>Sprite.from(&quot;Clampy the clamp&quot;)</code>.  (If you ever need a <code>Texture</code> object, you can get it the same way with <code>Texture.from(...)</code> just remember that <em>Sprites</em> go on screen and <em>Textures</em> hide inside sprites.)</p>

<p>For <em>Sounds</em>, all our sounds are stored in what PixiJS Sound calls <em>sound library</em>. To access it we have to import it as <code>import { sound } from &quot;@pixi/sound&quot;;</code>. That is <code>sound</code> with a <strong>lowercase s</strong>. From there you can play it by doing <code>sound.play(&quot;name we gave in the manifest&quot;);</code>.</p>

<aside class="warning">
PixiJS Sound names can be confusing, while <code>Sound</code> with uppercase is the class for a single sound file, <code>sound</code> with lowercase is the sound library object.
</aside>

<aside class="info">
Remember you can always access your assets with <code>Loader.shared.resources["the name you gave your asset in the manifest"];</code> and then use <code>.texture</code> for making sprites or <code>.sound</code> for playing sounds directly.
</aside>
<h2 id='advanced-loading'>Advanced loading</h2>
<p>Ok, we have seen how to load our basic <em>png</em> and <em>mp3</em> but what about other kinds of assets? What about <em>spritesheets</em>, <em>fonts</em>, <em>levels</em>, and more?<br>
This section will show some of the most common asset types and how to load and use them.</p>

<p>But before we start, a bit of how things will work behind the curtains: <em>Loader plugins</em>.<br>
The PixiJS Loader extends <a href="https://github.com/englercj/resource-loader">Resource Loader by Chad Engler</a> and includes some plugins for downloading and parsing images, and spritesheets however for other types we will need custom plugins (e.g. for WebFonts) or the plugin will come bundled with a library (e.g. PixiSound includes a loader plugin)</p>
<h3 id='spritesheets'>Spritesheets</h3>
<blockquote>
<p>Add this to your <code>assets.ts</code> array...</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="p">{</span> <span class="nl">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">you wont use this name</span><span class="dl">"</span><span class="p">,</span> <span class="nx">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">./yourSpritesheetUrl.json</span><span class="dl">"</span> <span class="p">}</span>
<span class="c1">// Don't add an entry for the .png file! Just make sure it exists next to your json file and it will work.</span>
</code></pre></div>
<blockquote>
<p>Then your textures from inside your spritesheet will exist in the cache! Ready to Sprite.from()</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="nx">Sprite</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">"</span><span class="s2">Name from inside your spritesheet</span><span class="dl">"</span><span class="p">);</span>
<span class="c1">// or</span>
<span class="nx">Texture</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">"</span><span class="s2">Name from inside your spritesheet</span><span class="dl">"</span><span class="p">);</span>
</code></pre></div>
<p>A spritesheet (also known as texture atlas) is a single image file with many assets inside next to a text file (in our case a <code>json</code> file) that explains how to slice that texture to extract all the assets. It is really good for performance and you should try to always use them.<br>
To create a spritesheet you can use paid programs like <a href="https://www.codeandweb.com/texturepacker">TexturePacker</a> or free ones like <a href="https://renderhjs.net/shoebox/">ShoeBox</a> or <a href="http://free-tex-packer.com/">FreeTexPacker</a>.<br>
If you have problems finding a <em>PixiJS</em> compatible format in the packer of your choice, it might also be called <em>JSON Hash format</em></p>

<p>PixiJS includes a spritesheet parser so all you need to do is provide the <em>url</em> for the <em>json</em> file. <strong>You shouldn&#39;t add the URL for .png file but it must be next to the json file!</strong></p>
<h3 id='fonts'>Fonts</h3>
<blockquote>
<p>Install PixiJS Webfont Loader by running <code>npm i pixi-webfont-loader</code> and then proceed to run this code <strong>before using your loader</strong></p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="c1">// Add before using Loader!!!</span>
<span class="nx">Loader</span><span class="p">.</span><span class="nx">registerPlugin</span><span class="p">(</span><span class="nx">WebfontLoaderPlugin</span><span class="p">);</span>
<span class="c1">// Now you can start using loader like Loader.shared.add(assets);</span>
</code></pre></div>
<blockquote>
<p>Add your .css fonts to your <code>assets.ts</code> array</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="p">{</span> <span class="nl">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">you wont use this name</span><span class="dl">"</span><span class="p">,</span> <span class="nx">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">./fonts/stylesheet.css</span><span class="dl">"</span> <span class="p">}</span>
</code></pre></div>
<blockquote>
<p>Your fonts will be registered into the system and you can just ask for the Font Name. You can check the font name by opening your <code>.css</code> with a text editor and checking the <code>font-family</code> inside. Also, remember you can make your text style with the <a href="https://pixijs.io/pixi-text-style">PixiJS Textstyle editor</a>.</p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">customStyleFont</span><span class="p">:</span> <span class="nx">TextStyle</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TextStyle</span><span class="p">({</span>
    <span class="na">fontFamily</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Open Sans Condensed</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// name from inside the .css file</span>
<span class="p">});</span>
<span class="k">new</span> <span class="nx">Text</span><span class="p">(</span><span class="dl">'</span><span class="s1">Ready to use!</span><span class="dl">'</span><span class="p">,</span> <span class="nx">customStyleFont</span><span class="p">);</span> <span class="c1">// Text supports unicode!</span>
</code></pre></div>
<p>When I showed you text examples I used system fonts on purpose, but what if you want to use your custom font? or a google font?<br>
In the web world, there are many font formats: <code>ttf</code>, <code>otf</code>, <code>woff</code>, <code>woff2</code>; but how do we make sure we have the right font format for each browser? Simple, WE HAVE THEM ALL!<br>
An easy way is to get the font file you want to use and convert it using a service like <a href="https://transfonter.org/">Transfonter</a>. That will give you a <code>.css</code> file and all the formats required.<br>
Another way is to go to <a href="https://fonts.google.com/">Google Fonts</a> and download a Webfont from there.  </p>

<p>To load our font&#39;s <code>css</code> file we are going to need a <em>Loader plugin</em>: <a href="https://github.com/miltoncandelero/pixi-webfont-loader">PixiJS Webfont Loader</a>.<br>
You can install the plugin by running <code>npm i pixi-webfont-loader</code> in a console in your project and then inside your code you must register the plugin.</p>

<aside class="info">
If you don't want to trouble yourself converting your original font file (<code>ttf</code>, <code>otf</code>, <code>woff</code>, or <code>woff2</code>) font into a <code>.css</code> Webfont you can still use it by loading it directly as long as you are using a version of PixiJS Webfont Loader equal or greater than 1.0.0.
</aside>
<h3 id='maps-from-level-editors-or-custom-txt-json-xml-etc'>Maps from level editors or custom txt, json, xml, etc.</h3>
<blockquote>
<p>Just add your custom file to your <code>assets.ts</code></p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="p">{</span> <span class="nl">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">my text</span><span class="dl">"</span><span class="p">,</span> <span class="nx">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">./myTextFile.txt</span><span class="dl">"</span> <span class="p">},</span>
<span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">my json</span><span class="dl">"</span><span class="p">,</span> <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">./myJsonFile.json</span><span class="dl">"</span> <span class="p">},</span>
<span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">my xml</span><span class="dl">"</span><span class="p">,</span> <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">./myXMLFile.xml</span><span class="dl">"</span> <span class="p">},</span>
</code></pre></div>
<blockquote>
<p>A good way to see what you got is to <code>console.log()</code> the <code>data</code></p>
</blockquote>
<div class="highlight"><pre class="highlight typescript"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">Loader</span><span class="p">.</span><span class="nx">shared</span><span class="p">.</span><span class="nx">resources</span><span class="p">[</span><span class="dl">"</span><span class="s2">my text</span><span class="dl">"</span><span class="p">].</span><span class="nx">data</span><span class="p">);</span> 
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">Loader</span><span class="p">.</span><span class="nx">shared</span><span class="p">.</span><span class="nx">resources</span><span class="p">[</span><span class="dl">"</span><span class="s2">my json</span><span class="dl">"</span><span class="p">].</span><span class="nx">data</span><span class="p">);</span> 
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">Loader</span><span class="p">.</span><span class="nx">shared</span><span class="p">.</span><span class="nx">resources</span><span class="p">[</span><span class="dl">"</span><span class="s2">my xml</span><span class="dl">"</span><span class="p">].</span><span class="nx">data</span><span class="p">);</span> 
</code></pre></div>
<p>The <em>Loader</em> class will recognize simple text formats like <code>txt</code>, <code>json</code> or <code>xml</code> and will give out a somewhat usable object inside the <code>data</code> object of the resource.</p>

<aside class="info">
If a json file happens to be a spritesheet, the Loader will recognize it automatically and process it accordingly. No extra steps are needed!
</aside>

<p>If you would like to parse a particular kind of file you will need to write your own <em>Loader plugin</em>. I might write a tutorial for that in the future but for now, you can read <a href="https://medium.com/@bigtimebuddy/new-pixijs-v5-plugins-75a7d86afb6">this one by Matt Karl</a>.</p>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
